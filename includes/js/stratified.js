/* stratified.js */
var __oni_rt={};(function(exports){function CFException_toString(){var e=this.name+": "+this.message;if(this.__oni_stack){for(var t=0;t<this.__oni_stack.length;++t){var n=this.__oni_stack[t];if(n.length==1)n=n[0];else n="    at "+n.slice(0,2).join(":");e+="\n"+n}}return e}function adopt_native_stack(e,t){if(!e.stack)return;if(exports.hostenv!=="nodejs"){e.stack="";return}var n=String(e.stack);var r=n.indexOf(": ");var i=r===-1?0:r+2;if(n.lastIndexOf("\n",i)!==-1)i=0;var s=String(e.message);if(s&&n.lastIndexOf(s,i)==i){n=n.slice(i+s.length)}else{n=n.replace(/^\w*Error/,"")}n=n.trim();e.stack="";var o=n.split("\n");var u;for(u=0;u<o.length;u++){if(t&&o[u].indexOf(t)!==-1||o[u].indexOf("stratified-node.js")!==-1||o[u].indexOf("stratified.js")!==-1){break}e.__oni_stack.push([o[u]])}}function CFException(e,t,n,r){this.type=e;this.val=t;if(e=="t"&&(t instanceof Error||typeof t=="object"&&t.message)){if(t._oniE!==token_oniE){t._oniE=token_oniE;t.__oni_stack=t.__oni_stack||[];t.line=n;t.file=r||"unknown SJS source";adopt_native_stack(t,r);if(!t.hasOwnProperty("toString"))t.toString=CFException_toString}if(n)t.__oni_stack.push([r||"unknown SJS source",n])}}function ReturnToParentContinuation(e,t,n){this.frame=e;this.idx=t;this.val=n}function cont(e,t,n){var r=e.cont(t,n);while(r&&r.__oni_rtpc){r=r.execute()}return r}function is_ef(e){return e&&e.__oni_ef}function setEFProto(e){for(var t in EF_Proto)e[t]=EF_Proto[t]}function mergeCallstacks(e,t){if(e.callstack){e.callstack=e.callstack.concat(t.callstack);if(e.callstack.length>20)e.callstack.splice(20/2,e.callstack.length-20+1,["    ...(frames omitted)"])}else{e.callstack=t.callstack}}function execIN(e,t){if(!e||e.__oni_dis!=token_dis){return e}return e.exec(e.ndata,t)}function Env(e,t,n,r,i,s,o,u){this.aobj=e;this.tobj=t;this.file=n;this.blbref=r;this.blrref=i;this.blscope=s;this.fold=o;this.branch=u}function copyEnv(e){return new Env(e.aobj,e.tobj,e.file,e.blbref,e.blrref,e.blscope,e.fold,e.branch)}function I_call(e,t){try{var n=e[0].call(t);if(is_ef(n)){if(!n.callstack)n.callstack=[];n.callstack.push([t.file,e[1]])}return n}catch(r){if(r&&r.__oni_cfx){if(r.type=="blb"&&r.ef==t.blscope){return UNDEF}}else{r=new CFException("t",r,e[1],t.file)}return r}}function I_nblock(e,t){try{return e[0].call(t)}catch(n){if(!(n&&n.__oni_cfx)){n=new CFException("t",n,e[1],t.file)}return n}}function I_blocklambda(e,t){return e.bind(t)}function EF_Seq(e,t){this.ndata=e;this.env=t;if(e[0]&8){if(e[0]&64){this.env=copyEnv(t);this.env.blbref=t.blscope;this.env.blrref=t.blrref;this.env.blscope=this}else{t.blbref=this;t.blrref=this;t.blscope=this}}else if(e[0]&1){this.env=copyEnv(t);if(e[0]&64)this.env.blbref=t.blscope;this.env.blscope=null}this.tailcall=!(e[0]&8);this.swallow_r=e[0]&1;if(e[0]&32)this.swallow_r=2;this.sc=e[0]&(2|4);if(e[0]&16){this.unreturnable=true;this.toplevel=true}}function I_seq(e,t){return cont(new EF_Seq(e,t),1)}function EF_Sc(e,t){this.ndata=e;this.env=t;this.i=2;this.pars=[]}function I_sc(e,t){return cont(new EF_Sc(e,t),0)}function testIsFunction(e){if(typeof e=="function")return true;return!!/(?:\[[^o])|(?:^\/)/.exec(""+e)}function EF_Fcall(e,t){this.ndata=e;this.env=t;this.i=2;this.pars=[]}function I_fcall(e,t){return cont(new EF_Fcall(e,t),0)}function EF_If(e,t){this.ndata=e;this.env=t}function I_if(e,t){return cont(new EF_If(e,t),0)}function EF_Switch(e,t){this.ndata=e;this.env=t;this.phase=0}function I_switch(e,t){return cont(new EF_Switch(e,t),0)}function EF_Try(e,t){this.ndata=e;this.env=t;this.state=0}function I_try(e,t){return cont(new EF_Try(e,t),0)}function EF_Loop(e,t){this.ndata=e;this.env=t}function I_loop(e,t){return cont(new EF_Loop(e,t),e[0],true)}function EF_ForIn(e,t){this.ndata=e;this.env=t}function I_forin(e,t){return cont(new EF_ForIn(e,t),0)}function EF_Par(e,t){this.ndata=e;this.env=t;this.pending=0;this.children=new Array(this.ndata.length)}function I_par(e,t){return cont(new EF_Par(e,t),-1)}function EF_Alt(e,t){this.ndata=e;this.env=t;this.pending=0;this.children=new Array(this.ndata.length)}function I_alt(e,t){return cont(new EF_Alt(e,t),-1)}function EF_Suspend(e,t){this.ndata=e;this.env=t}function I_sus(e,t){return cont(new EF_Suspend(e,t),0)}function EF_Spawn(e,t,n,r){this.ndata=e;this.env=t;this.notifyAsync=n;this.notifyVal=r}function EF_SpawnWaitFrame(e){this.waitarr=e;e.push(this)}function I_spawn(e,t){function a(){r=true}function f(e){if(n!==undefined)return;n=e;r=false;if(!o.length){if(n&&n.__oni_cfx&&(n.type!="t"||n.val instanceof Error)){setTimeout(function(){if(!s)n.mapToJS(true)},0)}}else while(o.length)cont(o.shift(),n)}var n,r,i,s=false;var o=[];var u={abort:function(){if(!r)return;l.quench();l.abort();r=false;n=new CFException("t",new StratumAborted,e[0],t.file);while(o.length)cont(o.shift(),n)},value:function(){if(!r){s=true;return n}return new EF_SpawnWaitFrame(o)},waitforValue:function(){return this.value()},running:function(){return r},waiting:function(){return o.length},toString:function(){return"[object Stratum]"}};var l=new EF_Spawn(e,t,a,f);cont(l,0);return u}function EF_Collapse(e,t){this.ndata=e;this.env=t}function I_collapse(e,t){return cont(new EF_Collapse(e,t),0)}function dummy(){}function QuasiProto(e){this.parts=e}var UNDEF;var token_oniE={};var CFETypes={r:"return",b:"break",c:"continue",blb:"blocklambda break"};CFException.prototype={__oni_cfx:true,toString:function(){if(this.type in CFETypes)return"Unexpected "+CFETypes[this.type]+" statement";else return"Uncaught internal SJS control flow exception ("+this.type+":: "+this.val+")"},mapToJS:function(e){if(this.type=="t"){if(e&&this.val.__oni_stack){var t=window.onerror;var n=false;var r=this.val.toString();if(t){n=t.call(window,r,"",0,0,this.val)}if(!n){if(console){if(console.error)console.error(r);else console.log(r)}}}else throw this.val}else if(!this.ef)throw new Error(this.toString());else throw this}};ReturnToParentContinuation.prototype={__oni_rtpc:true,execute:function(){return this.frame.cont(this.idx,this.val)}};exports.is_ef=is_ef;var EF_Proto={toString:function(){return"<suspended SJS>"},__oni_ef:true,wait:function(){return this},setChildFrame:function(e,t){if(this.child_frame&&this.child_frame.callstack){mergeCallstacks(e,this.child_frame)}this.async=true;this.child_frame=e;e.parent=this;e.parent_idx=t},quench:function(){if(this.child_frame)this.child_frame.quench()},abort:function(){this.aborted=true;if(!this.child_frame){return this}else return this.child_frame.abort()},returnToParent:function(e){if(e&&e.__oni_cfx&&e.type=="t"&&this.callstack&&e.val.__oni_stack){e.val.__oni_stack=e.val.__oni_stack.concat(this.callstack)}if(this.swallow_r){if(e&&e.__oni_cfx){if(e.type=="r"){if(!e.ef||e.ef==this)e=e.val}}else if(is_ef(e))e.swallow_r=this.swallow_r;else if(this.swallow_r!==2)e=UNDEF}this.unreturnable=true;if(this.async){if(this.parent){return new ReturnToParentContinuation(this.parent,this.parent_idx,e)}else if(e&&e.__oni_cfx){e.mapToJS(true)}}else return e}};var token_dis={};exports.ex=execIN;exports.exseq=function(e,t,n,r){var i=I_seq(r,new Env(e,t,n));if(i&&i.__oni_cfx)return i.mapToJS();return i};exports.exbl=function(e,t){var n=I_seq(t,e);if(n&&n.__oni_cfx)return n.mapToJS();return n};var StratumAborted=exports.StratumAborted=function(){};StratumAborted.prototype=new Error("stratum aborted");exports.C=function(e,t){return{exec:I_call,ndata:[e,t],__oni_dis:token_dis}};exports.Nb=function(e,t){return{exec:I_nblock,ndata:[e,t],__oni_dis:token_dis}};exports.Bl=function(e){return{exec:I_blocklambda,ndata:e,__oni_dis:token_dis}};setEFProto(EF_Seq.prototype={});EF_Seq.prototype.cont=function(e,t){if(is_ef(t)){this.setChildFrame(t,e)}else{if(t&&t.__oni_cfx){if(t.type=="blb"&&t.ef==this.env.blscope){t=UNDEF}else{return this.returnToParent(t)}}while(e<this.ndata.length){if(this.sc&&e>1){if(this.sc==2){if(t)break}else{if(!t)break}}this.child_frame=null;t=execIN(this.ndata[e],this.env);if(this.aborted){if(is_ef(t)){t.quench();t=t.abort();return this.returnToParent(t)}}if(++e==this.ndata.length&&this.tailcall){break}if(t&&t.__oni_cfx){if(t.type==="blb"&&t.ef===this.env.blscope)t=undefined;break}else if(is_ef(t)){this.setChildFrame(t,e);return this}}return this.returnToParent(t)}};exports.Seq=function(){return{exec:I_seq,ndata:arguments,__oni_dis:token_dis}};setEFProto(EF_Sc.prototype={});EF_Sc.prototype.cont=function(e,t){if(is_ef(t)){this.setChildFrame(t,e)}else if(t&&t.__oni_cfx){return this.returnToParent(t)}else{this.child_frame=null;if(e==1){this.pars.push(t)}var n;while(this.i<this.ndata.length){n=execIN(this.ndata[this.i],this.env);if(this.aborted){if(is_ef(n)){n.quench();n=n.abort();return this.returnToParent(n)}}++this.i;if(n&&n.__oni_cfx)return this.returnToParent(n);if(is_ef(n)){this.setChildFrame(n,1);return this}this.pars.push(n)}this.child_frame=null;try{n=this.ndata[1].apply(this.env,this.pars)}catch(r){n=new CFException("t",r,this.ndata[0],this.env.file)}return this.returnToParent(n)}};exports.Sc=function(){return{exec:I_sc,ndata:arguments,__oni_dis:token_dis}};setEFProto(EF_Fcall.prototype={});EF_Fcall.prototype.cont=function(idx,val){if(is_ef(val)){this.setChildFrame(val,idx)}else if(val&&val.__oni_cfx){return this.returnToParent(val)}else if(idx==2){return this.returnToParent(this.o)}else{if(idx==1){if(this.i==3)this.l=val;else this.pars.push(val)}var rv;while(this.i<this.ndata.length){rv=execIN(this.ndata[this.i],this.env);if(this.aborted){if(is_ef(rv)){rv.quench();rv=rv.abort();return this.returnToParent(rv)}}++this.i;if(rv&&rv.__oni_cfx)return this.returnToParent(rv);if(is_ef(rv)){this.child_frame=null;this.setChildFrame(rv,1);return this}if(this.i==3)this.l=rv;else this.pars.push(rv)}this.child_frame=null;try{switch(this.ndata[0]){case 0:if(typeof this.l=="function"){rv=this.l.apply(null,this.pars)}else if(!testIsFunction(this.l)){rv=new CFException("t",new Error("'"+this.l+"' is not a function"),this.ndata[1],this.env.file)}else{var command="this.l(";for(var i=0;i<this.pars.length;++i){if(i)command+=",";command+="this.pars["+i+"]"}command+=")";rv=eval(command)}break;case 1:if(typeof this.l[0]==="undefined"){rv=new CFException("t",new Error("'"+this.l[1]+"' on '"+this.l[0]+"' is not a function"),this.ndata[1],this.env.file)}else if(typeof this.l[0][this.l[1]]=="function"){rv=this.l[0][this.l[1]].apply(this.l[0],this.pars)}else if(UA!=="msie"&&!testIsFunction(this.l[0][this.l[1]])){rv=new CFException("t",new Error("'"+this.l[0][this.l[1]]+"' is not a function"),this.ndata[1],this.env.file)}else{var command="this.l[0][this.l[1]](";for(var i=0;i<this.pars.length;++i){if(i)command+=",";command+="this.pars["+i+"]"}command+=")";rv=eval(command)}break;case 2:var ctor=this.l;if(ctor&&(/\{\s*\[native code\]\s*\}\s*$/.test(ctor.toString())||ctor.apply==undefined)){var pars=this.pars;var command="new ctor(";for(var i=0;i<pars.length;++i){if(i)command+=",";command+="pars["+i+"]"}command+=")";rv=eval(command)}else if(!testIsFunction(ctor)){rv=new CFException("t",new Error("'"+ctor+"' is not a function"),this.ndata[1],this.env.file)}else{var f=function(){};f.prototype=ctor.prototype;this.o=new f;rv=ctor.apply(this.o,this.pars);if(is_ef(rv)){this.setChildFrame(rv,2);return this}else{if(!rv||"object function".indexOf(typeof rv)==-1)rv=this.o}}break;default:rv=new CFException("i","Invalid Fcall mode")}}catch(e){if(e&&e.__oni_cfx){if(e.type=="blb"&&e.ef==this.env.blscope){rv=UNDEF}else rv=e}else rv=new CFException("t",e,this.ndata[1],this.env.file)}if(is_ef(rv)){if(this.aborted){rv=rv.abort();return this.returnToParent(rv)}if(!rv.callstack)rv.callstack=[];rv.callstack.push([this.env.file,this.ndata[1]])}return this.returnToParent(rv)}};exports.Fcall=function(){return{exec:I_fcall,ndata:arguments,__oni_dis:token_dis}};setEFProto(EF_If.prototype={});EF_If.prototype.cont=function(e,t){switch(e){case 0:t=execIN(this.ndata[0],this.env);if(this.aborted){if(is_ef(t)){t.quench();t=t.abort();return this.returnToParent(t)}};case 1:if(t&&t.__oni_cfx)break;if(is_ef(t)){this.setChildFrame(t,1);return this}if(t)t=execIN(this.ndata[1],this.env);else t=execIN(this.ndata[2],this.env);break;default:t=new CFException("i","invalid state in EF_If")}return this.returnToParent(t)};exports.If=function(e,t,n){return{exec:I_if,ndata:[e,t,n],__oni_dis:token_dis}};var Default={};exports.Default=Default;setEFProto(EF_Switch.prototype={});EF_Switch.prototype.cont=function(e,t){switch(this.phase){case 0:if(e==0){t=execIN(this.ndata[0],this.env);if(this.aborted){if(is_ef(t)){t.quench();t=t.abort();return this.returnToParent(t)}}}if(t&&t.__oni_cfx)return this.returnToParent(t);if(is_ef(t)){this.setChildFrame(t,1);return this}this.phase=1;this.testval=t;e=-1;case 1:while(true){if(e>-1){if(t&&t.__oni_cfx)return this.returnToParent(t);if(is_ef(t)){this.setChildFrame(t,e);return this}else if(t==Default||t==this.testval)break}if(++e>=this.ndata[1].length)return this.returnToParent(null);this.child_frame=null;t=execIN(this.ndata[1][e][0],this.env);if(this.aborted){if(is_ef(t)){t.quench();t=t.abort();return this.returnToParent(t)}}}this.phase=2;t=0;case 2:while(true){if(is_ef(t)){this.setChildFrame(t,e);return this}if(t&&t.__oni_cfx){if(t.type=="b"){t=t.val}return this.returnToParent(t)}if(e>=this.ndata[1].length){return this.returnToParent(t)}this.child_frame=null;t=execIN(this.ndata[1][e][1],this.env);if(this.aborted){if(is_ef(t)){t.quench();t=t.abort();return this.returnToParent(t)}}++e};default:throw new Error("Invalid phase in Switch SJS node")}};exports.Switch=function(e,t){return{exec:I_switch,ndata:[e,t],__oni_dis:token_dis}};setEFProto(EF_Try.prototype={});EF_Try.prototype.cont=function(e,t){if(is_ef(t)){this.setChildFrame(t,this.state)}else{switch(this.state){case 0:this.state=1;t=execIN(this.ndata[1],this.env);if(is_ef(t)){this.setChildFrame(t);return this};case 1:this.state=2;if(!this.aborted&&this.ndata[2]&&(t&&t.__oni_cfx&&t.type=="t"||this.ndata[0]&1)){var n;if(this.ndata[0]&1){n=t&&t.__oni_cfx?[t.val,true]:[t,false]}else n=t.val;t=this.ndata[2](this.env,n);if(this.aborted&&is_ef(t)){t=t.abort()}if(!this.NDATA_TRY_RETRACT_BLOCK&&!this.ndata[3])return this.returnToParent(t);if(is_ef(t)){this.child_frame=null;this.setChildFrame(t);return this}};case 2:this.state=3;this.rv=t;if(this.aborted&&this.ndata[4]){t=execIN(this.ndata[4],this.env);if(is_ef(t)){this.child_frame=null;this.setChildFrame(t);return this}};case 3:this.state=4;if(this.ndata[3]){t=execIN(this.ndata[3],this.env);if(is_ef(t)){this.child_frame=null;this.setChildFrame(t);return this}};case 4:if(this.rv&&this.rv.__oni_cfx&&!(t&&t.__oni_cfx)){t=this.rv}break;default:t=new CFException("i","invalid state in CF_Try")}return this.returnToParent(t)}};EF_Try.prototype.quench=function(){if(this.state!==4)this.child_frame.quench()};EF_Try.prototype.abort=function(){this.aborted=true;if(this.state!==4){var e=this.child_frame.abort();if(is_ef(e)){this.setChildFrame(e)}else{this.parent=UNDEF;if(cont(this,0)!==this){return}}}return this};exports.Try=function(){return{exec:I_try,ndata:arguments,__oni_dis:token_dis}};setEFProto(EF_Loop.prototype={});EF_Loop.prototype.cont=function(e,t){if(is_ef(t)){this.setChildFrame(t,e)}else{while(true){if(e==0){if(t&&t.__oni_cfx){return this.returnToParent(t)}t=execIN(this.ndata[1],this.env);if(this.aborted){if(is_ef(t)){t.quench();t=t.abort();return this.returnToParent(t)}}if(is_ef(t)){this.child_frame=null;this.setChildFrame(t,2);return this}e=2}if(e>1){if(e==2){if(!t||t&&t.__oni_cfx){return this.returnToParent(t)}}while(1){if(e>2){if(t&&t.__oni_cfx){if(t.type=="blb"&&t.ef==this.env.blscope){t=UNDEF}else{if(t.type=="b"){t=UNDEF}else if(t.type=="c"){t=UNDEF;break}return this.returnToParent(t)}}if(e>=this.ndata.length)break}this.child_frame=null;t=execIN(this.ndata[e+1],this.env);if(this.aborted){if(is_ef(t)){t.quench();t=t.abort();return this.returnToParent(t)}}++e;if(is_ef(t)){this.setChildFrame(t,e);return this}}e=1}if(this.ndata[2]){t=execIN(this.ndata[2],this.env);if(this.aborted){if(is_ef(t)){t.quench();t=t.abort();return this.returnToParent(t)}}if(is_ef(t)){this.child_frame=null;this.setChildFrame(t,0);return this}}e=0}}};exports.Loop=function(){return{exec:I_loop,ndata:arguments,__oni_dis:token_dis}};setEFProto(EF_ForIn.prototype={});EF_ForIn.prototype.cont=function(e,t){if(is_ef(t)){this.setChildFrame(t,e)}else{if(e==0){t=execIN(this.ndata[0],this.env);if(this.aborted){if(is_ef(t)){t.quench();t=t.abort();return this.returnToParent(t)}}if(is_ef(t)){this.child_frame=null;this.setChildFrame(t,1);return this}e=1}if(e==1){if(t&&t.__oni_cfx)return this.returnToParent(t);for(var n in t){if(typeof this.remainingX==="undefined"){t=this.ndata[1](this.env,n);if(t&&t.__oni_cfx){if(t.type=="b"){t=UNDEF}else if(t.type=="c"){t=UNDEF;continue}return this.returnToParent(t)}if(is_ef(t))this.remainingX=[]}else this.remainingX.push(n)}if(is_ef(t)){if(!this.remainingX)this.remainingX=[];this.child_frame=null;this.setChildFrame(t,2);return this}return this.returnToParent(t)}if(e==2){while(1){if(t&&t.__oni_cfx){if(t.type=="b"){t=UNDEF}else if(t.type=="c"){t=UNDEF;if(this.remainingX.length)continue}return this.returnToParent(t)}if(is_ef(t)){this.child_frame=null;this.setChildFrame(t,2);return this}if(!this.remainingX.length){return this.returnToParent(t)}t=this.ndata[1](this.env,this.remainingX.shift())}}}};exports.ForIn=function(e,t){return{exec:I_forin,ndata:[e,t],__oni_dis:token_dis}};setEFProto(EF_Par.prototype={});EF_Par.prototype.cont=function(e,t){if(is_ef(t)){this.setChildFrame(t,e)}else{if(e==-1){for(var n=0;n<this.ndata.length;++n){t=execIN(this.ndata[n],this.env);if(this.aborted){if(is_ef(t)){++this.pending;this.setChildFrame(t,n);this.quench();return this.abortInner()}return this.pendingCFE}else if(is_ef(t)){++this.pending;this.setChildFrame(t,n)}else if(t&&t.__oni_cfx){this.pendingCFE=t;this.quench();return this.abortInner()}}}else{--this.pending;this.children[e]=UNDEF;if(t&&t.__oni_cfx&&!this.aborted&&!(t.type==="blb"&&t.ef===this.env.blscope)){this.pendingCFE=t;this.quench();return this.returnToParent(this.abortInner())}}if(this.pending<2){if(!this.pendingCFE){if(this.pending==0)return this.returnToParent(t);for(var n=0;n<this.children.length;++n)if(this.children[n])return this.returnToParent(this.children[n]);return this.returnToParent(new CFException("i","invalid state in Par"))}else{if(this.pending==0)return this.returnToParent(this.pendingCFE)}}this.async=true;return this}};EF_Par.prototype.quench=function(){if(this.aborted)return;for(var e=0;e<this.children.length;++e){if(this.children[e])this.children[e].quench()}};EF_Par.prototype.abort=function(){this.parent=UNDEF;if(this.aborted){this.pendingCFE=UNDEF;return this}return this.abortInner()};EF_Par.prototype.abortInner=function(){this.aborted=true;for(var e=0;e<this.children.length;++e)if(this.children[e]){var t=this.children[e].abort();if(is_ef(t))this.setChildFrame(t,e);else{--this.pending;this.children[e]=UNDEF}}if(!this.pending)return this.pendingCFE;this.async=true;return this};EF_Par.prototype.setChildFrame=function(e,t){if(this.children[t]&&this.children[t].callstack){mergeCallstacks(e,this.children[t])}this.children[t]=e;e.parent=this;e.parent_idx=t};exports.Par=function(){return{exec:I_par,ndata:arguments,__oni_dis:token_dis}};setEFProto(EF_Alt.prototype={});EF_Alt.prototype.cont=function(e,t){if(is_ef(t)){this.setChildFrame(t,e)}else{if(e==-1){for(var n=0;n<this.ndata.length;++n){var r=copyEnv(this.env);r.fold=this;r.branch=n;t=execIN(this.ndata[n],r);if(this.aborted){if(is_ef(t)){++this.pending;this.setChildFrame(t,n);this.quench();return this.abortInner()}return this.pendingRV}else if(is_ef(t)){++this.pending;this.setChildFrame(t,n)}else{this.pendingRV=t;this.quench();return this.abortInner()}}}else{--this.pending;this.children[e]=UNDEF;if(this.collapsing){if(this.pending==1){var i=this.collapsing.cf;this.collapsing=UNDEF;cont(i,1)}return}else{if(!this.aborted){this.pendingRV=t;this.quench();return this.returnToParent(this.abortInner())}if(this.pending==0)return this.returnToParent(this.pendingRV)}}this.async=true;return this}};EF_Alt.prototype.quench=function(e){if(this.aborted)return;if(this.collapsing){this.children[this.collapsing.branch].quench()}else{for(var t=0;t<this.children.length;++t){if(t!==e&&this.children[t])this.children[t].quench()}}};EF_Alt.prototype.abort=function(){this.parent=UNDEF;if(this.aborted){this.pendingRV=UNDEF;return this}return this.abortInner()};EF_Alt.prototype.abortInner=function(){this.aborted=true;if(this.collapsing){var e=this.collapsing.branch;this.collapsing=UNDEF;var t=this.children[e].abort();if(is_ef(t))this.setChildFrame(t,e);else{--this.pending;this.children[e]=UNDEF}}else{for(var n=0;n<this.children.length;++n)if(this.children[n]){var t=this.children[n].abort();if(is_ef(t))this.setChildFrame(t,n);else{--this.pending;this.children[n]=UNDEF}}}if(!this.pending)return this.pendingRV;this.async=true;return this};EF_Alt.prototype.setChildFrame=function(e,t){if(this.children[t]&&this.children[t].callstack){mergeCallstacks(e,this.children[t])}this.children[t]=e;e.parent=this;e.parent_idx=t};EF_Alt.prototype.docollapse=function(e,t){this.quench(e);for(var n=0;n<this.children.length;++n){if(n==e)continue;if(this.children[n]){var r=this.children[n].abort();if(is_ef(r))this.setChildFrame(r,n);else{--this.pending;this.children[n]=UNDEF}}}if(this.pending<=1)return true;this.collapsing={branch:e,cf:t};return false};exports.Alt=function(){return{exec:I_alt,ndata:arguments,__oni_dis:token_dis}};setEFProto(EF_Suspend.prototype={});EF_Suspend.prototype.cont=function(e,t){if(is_ef(t)){this.setChildFrame(t,e)}else{switch(e){case 0:try{var n=this;var r=function(){try{cont(n,2,arguments)}catch(e){var t=function(){throw e};setTimeout(t,0)}};t=this.ndata[0](this.env,r)}catch(i){t=new CFException("t",i)}if(this.returning){if(is_ef(t)){this.setChildFrame(t,null);this.quench();t=this.abort();if(is_ef(t)){this.setChildFrame(t,3);this.async=true;return this}}return cont(this,3,null)}if(is_ef(t)){this.setChildFrame(t,1);return this};case 1:if(t&&t.__oni_cfx){this.returning=true;break}this.suspendCompleted=true;this.async=true;return this;case 2:if(this.returning){return}this.returning=true;if(t&&t.__oni_cfx){t=new CFException("i","Suspend: Resume function threw ("+t.toString()+")");break}this.retvals=t;if(!this.suspendCompleted){if(!this.child_frame){this.returning=true;return}else{this.quench();t=this.abort();if(is_ef(t)){this.setChildFrame(t,3);return this}}};case 3:try{this.ndata[1].apply(this.env,this.retvals);t=UNDEF}catch(i){t=new CFException("i","Suspend: Return function threw ("+i+")")}break;default:t=new CFException("i","Invalid state in Suspend ("+e+")")}return this.returnToParent(t)}};EF_Suspend.prototype.quench=function(){this.returning=true;if(!this.suspendCompleted)this.child_frame.quench()};EF_Suspend.prototype.abort=function(){this.returning=true;if(!this.suspendCompleted)return this.child_frame.abort()};exports.Suspend=function(e,t){return{exec:I_sus,ndata:[e,t],__oni_dis:token_dis}};setEFProto(EF_Spawn.prototype={});EF_Spawn.prototype.cont=function(e,t){if(e==0)t=execIN(this.ndata[1],this.env);if(is_ef(t)){this.setChildFrame(t,1);if(e==0)this.notifyAsync()}else{this.notifyVal(t)}};EF_Spawn.prototype.abort=function(){this.aborted=true;if(this.child_frame){var e=this.child_frame.abort();if(is_ef(e)){this.notifyAsync();this.setChildFrame(e,1)}}};setEFProto(EF_SpawnWaitFrame.prototype={});EF_SpawnWaitFrame.prototype.quench=function(){};EF_SpawnWaitFrame.prototype.abort=function(){var e=this.waitarr.indexOf(this);this.waitarr.splice(e,1)};EF_SpawnWaitFrame.prototype.cont=function(e){if(this.parent)cont(this.parent,this.parent_idx,e)};exports.Spawn=function(e,t){return{exec:I_spawn,ndata:[e,t],__oni_dis:token_dis}};setEFProto(EF_Collapse.prototype={});EF_Collapse.prototype.__oni_collapse=true;EF_Collapse.prototype.cont=function(e,t){if(e==0){var n=this.env.fold;if(!n)return new CFException("t",new Error("Unexpected collapse statement"),this.ndata,this.env.file);if(n.docollapse(this.env.branch,this))return true;this.async=true;return this}else if(e==1)return this.returnToParent(true);else return this.returnToParent(new CFException("t","Internal error in SJS runtime (collapse)",this.ndata,this.env.file))};EF_Collapse.prototype.quench=function(){};EF_Collapse.prototype.abort=function(){};exports.Collapse=function(e){return{exec:I_collapse,ndata:e,__oni_dis:token_dis}};exports.G=window;var hold0,clear0;if(exports.G.setImmediate){hold0=exports.G.setImmediate;clear0=exports.G.clearImmediate}else if(exports.G.postMessage&&!exports.G.importScripts){var postMessageIsAsync=true;var oldOnMessage=exports.G.onmessage;exports.G.onmessage=function(){postMessageIsAsync=false};exports.G.postMessage("","*");exports.G.onmessage=oldOnMessage;if(postMessageIsAsync){var MESSAGE_PREFIX="com.onilabs.hold0"+Math.random();var tasks={};function isStringAndStartsWith(e,t){return typeof e==="string"&&e.substring(0,t.length)===t}function onGlobalMessage(e){if(e.source===exports.G&&isStringAndStartsWith(e.data,MESSAGE_PREFIX)){var t=e.data.substring(MESSAGE_PREFIX.length);var n;if(n=tasks[t]){delete tasks[t];n()}}}if(exports.G.addEventListener){exports.G.addEventListener("message",onGlobalMessage,false)}else{exports.G.attachEvent("onmessage",onGlobalMessage)}var id_counter=1;var hold0=function(e){var t=id_counter++;tasks[t]=e;exports.G.postMessage(MESSAGE_PREFIX+t,"*");return t};var clear0=function(e){delete tasks[e]}}}if(!hold0){hold0=function(e){return setTimeout(e,0)};clear0=clearTimeout}exports.Hold=function(e){if(e===UNDEF)return{__oni_ef:true,wait:function(){return this},quench:dummy,abort:dummy};if(e===0){var t={__oni_ef:true,wait:function(){return this},abort:dummy,quench:function(){t=null;clear0(this.co)},co:hold0(function(){if(t&&t.parent)cont(t.parent,t.parent_idx,UNDEF)})};return t}else{var t={__oni_ef:true,wait:function(){return this},abort:dummy,quench:function(){t=null;clearTimeout(this.co)}};t.co=setTimeout(function(){if(t&&t.parent)cont(t.parent,t.parent_idx,UNDEF)},e);return t}};exports.Throw=function(e,t,n){return new CFException("t",e,t,n)};exports.Arr=function(){return Array.prototype.slice.call(arguments,0)};exports.Obj=function(){var e=new Object;for(var t=0;t<arguments[0].length;++t)e[arguments[0][t]]=arguments[t+1];return e};exports.QuasiProto=QuasiProto;exports.Quasi=function(){return new QuasiProto(Array.prototype.slice.call(arguments,0))};exports.Return=function(e){return new CFException("r",e)};exports.Break=function(e){return new CFException("b",e)};exports.Cont=function(e){return new CFException("c",e)};exports.BlBreak=function(e,t){var n=new CFException("blb",t);if(!e.blbref)throw new Error("Internal runtime error; no reference frame in BlBreak");if(e.blbref.unreturnable&&!e.blbref.toplevel)throw new Error("Blocklambda break to inactive scope");n.ef=e.blbref;return n};exports.BlReturn=function(e){var t=new CFException("r",e);if(!this.blrref)throw new Error("Internal runtime error; no reference frame in BlReturn");if(this.blrref.unreturnable){if(this.blrref.toplevel)throw new Error("Invalid blocklambda 'return' statement; 'return' is only allowed in blocklambdas that are nested in functions");else{throw new Error("Blocklambda return to inactive function")}}t.ef=this.blrref;return t};exports.With=function(e,t){return t(this,e)};exports.join_str=function(){var e="";for(var t=0,n=arguments.length;t<n;++t)e+=arguments[t];return e};exports.infix={"+":function(e,t){return e+t},"-":function(e,t){return e-t},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"<<":function(e,t){return e<<t},">>":function(e,t){return e>>t},">>>":function(e,t){return e>>>t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},"==":function(e,t){return e==t},"!=":function(e,t){return e!=t},"===":function(e,t){return e===t},"!==":function(e,t){return e!==t},"&":function(e,t){return e&t},"^":function(e,t){return e^t},"|":function(e,t){return e|t},",":function(e,t){return e,t},"instanceof":function(e,t){return e instanceof t},"in":function(e,t){return e in t}};var UA=navigator.userAgent.toLowerCase();if(UA.indexOf(" chrome/")>=0)UA="chrome";else if(UA.indexOf(" firefox/")>=0)UA="firefox";else if(UA.indexOf(" safari/")>=0)UA="safari";else if(UA.indexOf(" msie ")>=0)UA="msie";else UA="unknown";exports.hostenv="xbrowser";exports.UA=UA;exports.modules={};exports.modsrc={}})(__oni_rt);(function(e){function t(e,t){e.decl_scopes.push({vars:[],funs:"",fscoped_ctx:0,bl:t,continue_scope:0,break_scope:0});if(t){var n=e.decl_scopes[e.decl_scopes.length-2];n.notail=true}}function n(e){var t="";if(e.vars.length)t+="var "+e.vars.join(",")+";";t+=e.funs;return t}function r(e){return e.decl_scopes[e.decl_scopes.length-1]}function i(e){e.stmt_scopes.push({seq:[]})}function s(e,t,n){var r=e.stmt_scopes.pop().seq;var i="";if(r.length){if(e.js_ctx==0){if(t)i+=t;for(var s=0;s<r.length;++s){var o=r[s].v();if(o.length){if(s||t)i+=",";i+=o}}if(n)i+=n}else{for(var s=0;s<r.length;++s)i+=r[s].nb()}}return i}function o(e){return e.stmt_scopes[e.stmt_scopes.length-1]}function u(e){switch(e.mode){case"debug":e.allow_nblock=false;e.full_nblock=false;break;case"optimize":e.allow_nblock=true;e.full_nblock=true;break;case"normal":default:e.allow_nblock=true;e.full_nblock=false}if(typeof e.scopes!=="undefined")throw new Error("Internal parser error: Nested script");e.decl_scopes=[];e.stmt_scopes=[];e.js_ctx=0;t(e);i(e)}function a(e,t){if(e==C)return;if(e.is_compound_stmt){for(var n=0;n<e.stmts.length;++n)a(e.stmts[n],t);return}else if(e.is_var_decl){e.collect_var_decls(r(t).vars);if(e.is_empty)return}else if(e.is_fun_decl){r(t).funs+=e.fun_decl();return}var i=o(t).seq;if(e.is_nblock&&t.js_ctx==0){var s=i.length?i[i.length-1]:null;if(!s||!s.is_nblock_seq){s=new y(t);i.push(s)}s.pushStmt(e)}else i.push(e)}function f(e){var t=e.decl_scopes.pop();var r=n(t)+s(e,(e.globalReturn?"return ":"")+"__oni_rt.exseq(this.arguments,this,"+e.filename+",["+(16|8),"])");return r}function l(e){switch(o(e).seq.length){case 1:var t=e.stmt_scopes.pop().seq[0];t.is_var_decl=false;return t;case 0:e.stmt_scopes.pop();return C;default:return new p(s(e))}}function c(e,t,n){var r="__oni_rt.Nb(function(){";if(t)r+="return ";return r+e+"},"+(n||0)+")"}function h(){}function p(e){this.seq=e}function d(e,t){this.exp=e;this.clauses=t}function v(e,t,n,r,i){this.is_nblock=r.allow_nblock;if(i&&r.js_ctx)n="return "+n;this.code="function "+e+X(t)+n+"}"}function m(e,t,n,i){if(r(i).fscoped_ctx){return S([[new K(e,i),new v("",t,n,i)]],i)}else return new g(e,t,n,i)}function g(e,t,n,r){this.code="function "+e+X(t)+n+"}"}function y(){this.stmts=[]}function b(e){this.stmts=[];this.pctx=e}function w(e,t){this.exp=e;this.line=this.exp.line;this.is_nblock=e.is_nblock}function E(e,t){var n=new b(t);for(var r=0;r<e.length;++r)n.stmts.push(new x(e[r],t));return n}function S(e,t){return E(e,t).toBlock()}function x(e,t){this.d=e;if(!this.d[0].is_id)this.is_dest=true;this.is_empty=this.d.length<2;this.pctx=t;this.line=t.line;if(!this.is_empty)this.is_nblock=t.allow_nblock&&e[1].is_nblock&&!this.is_dest}function T(e,t,n,r){this.t=e;this.c=t;this.a=n;this.line=e.line;this.file=r.filename;this.is_nblock=r.full_nblock&&e.is_nblock&&t.is_nblock&&(!n||n.is_nblock)}function N(e,t,n){this.block=e;this.crf=t;this.file=n.filename}function k(e,t){this.exp=e;this.line=e.line;this.file=t.filename;this.is_nblock=t.full_nblock&&e.is_nblock}function L(e,t){this.line=t.line;this.exp=e}function A(e,t){this.line=t.line-t.newline;this.exp=e;this.js_ctx=t.js_ctx;this.is_nblock=t.allow_nblock&&(e?e.is_nblock:true)}function O(e){this.line=e.line}function M(e,t,n){this.f=e;this.lbl=n;this.is_nblock=true;this.js_ctx=t.js_ctx}function _(e,t){this.line=e.line;this.lbl=t;this.is_nblock=true}function D(e,t,n,r,i,s){var o;if(e||t){if(t)o=E(t,s);else o=new b(s);if(e)o.stmts.push(new w(e,s));o.stmts.push(new P(0,n,i,r));o=o.toBlock()}else o=new P(0,n,i,r);return o}function P(e,t,n,r){this.init_state=e;this.test_exp=t;this.inc_exp=r;this.body=n}function H(e,t,n,r,i){var s;if(t){s=E([t],i);s.stmts.push(new B(t[0],n,r,i));s=s.toBlock()}else s=new B(e,n,r,i);return s}function B(e,t,n,r){this.lhs=e;this.obj=t;this.body=n;this.pctx=r}function j(e,t,n){this.exp=e;this.body=t;this.line=this.exp.line;this.file=n.filename;this.is_nblock=n.allow_nblock&&e.is_nblock&&t.is_nblock}function F(e,t,n){this.value=e;this.line=t.line}function I(e,t,n,r){this.left=e;this.id=t;this.right=n;this.line=r.line;this.is_nblock=r.allow_nblock&&e.is_nblock&&n.is_nblock}function q(e,t){this.is_nblock=t.allow_nblock;this.line=t.line;this.parts=e;for(var n=0,r=e.length;n<r;++n){if(Array.isArray(e[n])&&!e[n][0].is_nblock){this.is_nblock=false;break}}}function R(e,t){this.parts=e;this.line=t.line;this.is_nblock=false}function U(e,t,n,r){if(!e.is_ref&&!e.is_id){this.is_dest=true;if(t!="=")throw new Error("Invalid operator in destructuring assignment")}this.left=e;this.id=t;this.right=n;this.line=r.line;this.is_nblock=r.allow_nblock&&e.is_nblock&&n.is_nblock&&!this.is_dest}function z(e,t,n){this.id=e;this.right=t;this.line=n.line;this.is_nblock=n.allow_nblock&&t.is_nblock&&e!="spawn"}function W(e,t,n){if(!e.is_ref&&!e.is_id)throw new Error("Invalid argument for postfix op '"+t+"'");this.left=e;this.id=t;this.line=n.line;this.is_nblock=n.allow_nblock&&e.is_nblock}function X(e){var t="";var n=true;var r=[];if(!e.length)return"(){";var i="";try{for(var s=0;s<e.length;++s){if(n&&!(e[s]instanceof K))n=false;e[s].collect_var_decls(r);i+=e[s].destruct("arguments["+s+"]")}if(n){return"("+r.join(",")+"){"}if(r.length){t+="var "+r.join(",")+";"}t+=i;return"(){"+t}catch(o){throw new Error("Invalid syntax in parameter list")}}function V(e,t,n,r){this.is_nblock=n.allow_nblock;this.js_ctx=n.js_ctx;this.line=n.line;this.bound=r;this.code="function";var i=[];if(e){if(e.collect_pars)e.collect_pars(i);else i.push(e)}this.code+=X(i);if(n.js_ctx){this.code+="return "+t.nb()+"}"}else{this.code+="return __oni_rt.exseq(arguments,this,"+n.filename+",["+(1+32)+","+t.v()+"])}"}}function $(e,t,n){if(t.is_fun_call){t.args.unshift(e);if(!t.is_nblock)t.nblock_form=false;return t}else return new Y(t,[e],n)}function J(e,t){if(e=="hold"){var n=new F("__oni_rt.Hold",t);n.is_id=true;return n}else if(e=="arguments"){return new Q("arguments","aobj",t)}return new K(e,t)}function K(e,t){this.name=e;this.line=t.line}function Q(e,t,n){this.js_ctx=n.js_ctx;this.line=n.line;this.name=e;this.ename=t}function G(e){for(var t=0;t<e.length;++t)if(!e[t].is_nblock)return false;return true}function Y(e,t,n){this.l=e;this.args=t;this.nblock_form=e.is_nblock&&G(t);this.line=n.line}function Z(e,t,n){this.l=e;this.name=t;this.line=n.line;this.is_nblock=n.allow_nblock&&e.is_nblock}function et(e,t,n){this.l=e;this.idxexp=t;this.line=n.line;this.is_nblock=n.allow_nblock&&e.is_nblock&&t.is_nblock}function tt(e,t){this.e=e;this.is_nblock=t.allow_nblock&&e.is_nblock}function nt(e,t){this.elements=e;this.line=t.line;this.is_nblock=t.allow_nblock&&G(e)}function rt(e,t){this.props=e;this.line=t.line;this.is_nblock=t.allow_nblock&&function(){for(var t=0;t<e.length;++t){if(!e[t][2].is_nblock)return false}return true}()}function it(e){if(e.charAt(0)=="'"||e.charAt(0)=='"')return e;return'"'+e+'"'}function st(e,t,n,r){this.t=e;this.c=t;this.a=n;this.line=e.line;this.is_nblock=r.allow_nblock&&e.is_nblock&&t.is_nblock&&(n===undefined||n.is_nblock)}function ot(e,t){this.exp=e;this.args=t;this.line=e.line}function ut(e,t,n,r){if(n[0]||n[1]||n[2])return new N(new at(e,t),n,r);else return new at(e,t)}function at(e,t){this.op=e;this.blocks=t}function ft(e,t,n,r,i){var s;if(e){s=E(t,i);s.stmts.push(lt(t,n,r,i));s=s.toBlock()}else s=lt(t,n,r,i);return s}function lt(e,t,n,r){var i=n[0]||n[1]||n[2];var s=new ct(e,t,i,r);if(i)s=new ht((new N(s,n,r)).v(),r);return s}function ct(e,t,n,r){this.decls=e;this.block=t;this.wrapped=n;this.file=r.filename}function ht(e,t){this.code=e;this.line=t.line;this.file=t.filename}function pt(e,t,n,r,i){var s;if(e){if(!t.is_id)throw new Error("Variable name expected in 'using' expression");s=E([[t]],i);s.stmts.push(new dt(t,n,r,i));s=s.toBlock()}else s=new dt(t,n,r,i);return s}function dt(e,t,n,r){this.line=r.line;this.body=n;this.assign1=new U(new K("_oniW",r),"=",t,r);if(e)this.assign2=new U(e,"=",new K("_oniW",r),r)}function vt(e,t,n){this.code="__oni_rt.Bl(function"+X(e)+t+"})"}function mt(e,t){this.lbl=e;this.stmt=t}function gt(){}function St(){}function xt(e,t){this.id=e;this.value=t}function Tt(e){if(e.charAt(0)==="@"){this.alternate=true;this.id="<@id>";this.value=e.substr(1)}else this.value=e}function Ct(e,t){var n=new St;n.id=e;if(t)n.tokenizer=t;Nt.put(e,n);return n}function kt(e,t){var n=e.id;if(n=="<@id>")return"@"+e.value;if(n=="<id>"||n=="<string>"||n=="<number>")return e.value;if(n=='"'){if((e=Xt(t)).id!="<string>"||Xt(t,undefined,wt).id!='istr-"')throw new Error("Non-literal strings can't be used as property names ("+e+")");return'"'+e.value+'"'}throw new Error("Invalid object literal syntax; property name expected, but saw "+e)}function Lt(e){i(e);while(e.token.id!="}"){var t=Ut(e);a(t,e)}Xt(e,"}");return l(e)}function At(e){t(e,true);i(e);while(e.token.id!="}"){var r=Ut(e);a(r,e);}Xt(e,"}");var o=e.decl_scopes.pop();var u=1+64;if(o.notail)u+=8;return n(o)+s(e,"return __oni_rt.exbl(this,["+u,"])")}function Ot(e,t){var n;if(e=="||"){n=[];Xt(t)}else{n=Dt(t,"|","|")}var r=At(t);return new vt(n,r,t)}function Mt(e,r){t(e);i(e);Xt(e,"{");while(e.token.id!="}"){var o=Ut(e);a(o,e)}Xt(e,"}");var u=e.decl_scopes.pop();var f=1;if(u.notail)f+=8;if(r)f+=32;return n(u)+s(e,"return __oni_rt.exseq(arguments,this,"+e.filename+",["+f,"])")}function _t(e){var t=e.token;Xt(e);var n=t.exsf(e);while(e.token.id!="|"&&e.token.excbp>110){t=e.token;Xt(e);n=t.excf(n,e)}return n}function Dt(e,t,n){if(!t){t="(";n=")"}var r=[];Xt(e,t);while(e.token.id!=n){if(r.length)Xt(e,",");switch(e.token.id){case"{":case"[":r.push(_t(e));break;case"<id>":r.push(e.token.exsf(e));Xt(e);break;default:throw new Error("Expected function parameter but found '"+e.token+"'")}token=e.token}Xt(e,n);return r}function Pt(e){var t=Xt(e);if(e.token.id!=="<id>"&&e.token.id!=="<@id>")throw new Error("Unexpected "+e.token+" in quasi template");if(e.src.charAt(e.lastIndex)!="("){return t.exsf(e)}else{Xt(e);Xt(e,"(");var n=[];while(e.token.id!=")"){if(n.length)Xt(e,",");n.push(zt(e,110))}return new Y(t.exsf(e),n,e)}}function Ht(e){return e.id==";"||e.id=="}"||e.id=="<eof>"}function Bt(e){if(e.token.id!="}"&&e.token.id!="<eof>"&&!e.newline)Xt(e,";")}function jt(e,t){var n=[];var r=t?Wt:zt;do{if(n.length)Xt(e,",");var i=r(e,120);if(e.token.id=="="){Xt(e);var s=r(e,110);n.push([i,s])}else n.push([i])}while(e.token.id==",");return n}function Ft(e){var t=[];var n=null;if(e.token.id=="catch"||e.token.value=="catchall"){var r=e.token.value=="catchall";n=[];Xt(e);n.push(Xt(e,"(").value);Xt(e,"<id>");Xt(e,")");Xt(e,"{");n.push(Lt(e));n.push(r)}t.push(n);if(e.token.value=="retract"){Xt(e);Xt(e,"{");t.push(Lt(e))}else t.push(null);if(e.token.id=="finally"){Xt(e);Xt(e,"{");t.push(Lt(e))}else t.push(null);return t}function It(e,t){var n={src:e,line:1,lastIndex:0,token:null};if(t)for(var r in t)n[r]=t[r];return n}function qt(e,t){var n=It(e+"\n",t);try{return Rt(n)}catch(r){var i=r.mes||r;var s=r.line||n.line;var o=new Error("SJS syntax error "+(n.filename?"in "+n.filename+",":"at")+" line "+s+": "+i);o.compileError={message:i,line:s};throw o}}function Rt(e){u(e);Xt(e);while(e.token.id!="<eof>"){var t=Ut(e);a(t,e);}return f(e)}function Ut(e){var t=e.token;Xt(e);if(t.stmtf){return t.stmtf(e)}else if(t.id=="<id>"&&e.token.id==":"){Xt(e);var n=Ut(e);return new mt(t.value,n)}else{var r=zt(e,0,t);Bt(e);return new w(r,e)}}function zt(e,t,n){t=t||0;if(!n){n=e.token;Xt(e)}var r=n.exsf(e);while(t<e.token.excbp){n=e.token;if(e.newline&&n.asi_restricted)return r;Xt(e);r=n.excf(r,e)}return r}function Wt(e,t,n){t=t||0;if(!n){n=e.token;Xt(e)}var r=n.exsf(e);while(t<e.token.excbp&&e.token.id!="in"){n=e.token;if(e.newline&&n.asi_restricted)return r;Xt(e);r=n.excf(r,e)}return r}function Xt(e,t,n){if(!n){if(e.token)n=e.token.tokenizer;else n=yt}if(t&&(!e.token||e.token.id!=t))throw new Error("Unexpected "+e.token);e.token=null;e.newline=0;while(!e.token){n.lastIndex=e.lastIndex;var r=n.exec(e.src);if(!r){e.token=Nt.lookup("<eof>");break}e.lastIndex=n.lastIndex;if(n==yt){if(r[4]){e.token=Nt.lookup(r[4]);if(!e.token){e.token=new Tt(r[4])}}else if(r[1]){var i=r[1].match(/(?:\r\n|\n|\r)/g);if(i){e.line+=i.length;e.newline+=i.length}}else if(r[5])e.token=new xt("<string>",r[5]);else if(r[6]){var s=r[6];var i=s.match(/(?:\r\n|\n|\r)/g);e.line+=i.length;e.newline+=i.length;s=s.replace(/\\(?:\r\n|\n|\r)/g,"").replace(/(?:\r\n|\n|\r)/g,"\\n");e.token=new xt("<string>",s)}else if(r[2])e.token=new xt("<number>",r[2]);else if(r[3])e.token=new xt("<regex>",r[3]);else if(r[7])throw new Error("Unexpected characters: '"+r[7]+"'");else throw new Error("Internal scanner error")}else if(n==bt){if(r[2]){e.token=Nt.lookup(r[2]);if(!e.token){e.token=new Tt(r[2])}}else if(r[1]){var i=r[1].match(/(?:\r\n|\n|\r)/g);if(i){e.line+=i.length;e.newline+=i.length}}else{n=yt}}else if(n==wt){if(r[1])e.token=new xt("<string>",r[1]);else if(r[2]){++e.line;++e.newline}else if(r[3]){++e.line;++e.newline;e.token=new xt("<string>","\\n")}else if(r[4]){e.token=Nt.lookup("istr-"+r[4])}}else if(n==Et){if(r[1])e.token=new xt("<string>",r[1]);else if(r[2]){++e.line;++e.newline}else if(r[3]){++e.line;++e.newline;e.token=new xt("<string>","\\n")}else if(r[4]){e.token=Nt.lookup("quasi-"+r[4])}}else throw new Error("Internal scanner error: no tokenizer")}return e.token}h.prototype={is_nblock:false,v:function(e){if(this.is_nblock&&this.nblock_val)return c(this.nblock_val(),this.is_value,this.line);else return this.val(e)},nb:function(){if(this.nblock_val)return this.nblock_val();else throw new Error("Illegal statement in __js block")}};p.prototype=new h;p.prototype.nblock_val=function(){return this.seq};p.prototype.val=function(e){return this.seq.length?e?this.seq:"__oni_rt.Seq("+0+","+this.seq+")":"0"};d.prototype=new h;d.prototype.nblock_val=function(){var e="switch("+this.exp.nb()+"){";for(var t=0,n=this.clauses.length;t<n;++t){var r=this.clauses[t];e+=(r[0]?"case "+r[0].nb()+":":"default:")+r[1].nb()}return e+"}"};d.prototype.val=function(){var e="[";for(var t=0,n=this.clauses.length;t<n;++t){var r=this.clauses[t];if(t)e+=",";e+="["+(r[0]?r[0].v():"__oni_rt.Default")+","+r[1].v()+"]"}e+="]";return"__oni_rt.Switch("+this.exp.v()+","+e+")"};v.prototype=new h;v.prototype.v=function(){return this.code};v.prototype.nblock_val=function(){return this.code};g.prototype=new h;g.prototype.is_fun_decl=true;g.prototype.fun_decl=function(){return this.code};y.prototype=new h;y.prototype.is_nblock=true;y.prototype.is_nblock_seq=true;y.prototype.pushStmt=function(e){this.stmts.push(e);if(typeof this.line==="undefined")this.line=this.stmts[0].line};y.prototype.nblock_val=function(){var e="";for(var t=0;t<this.stmts.length-1;++t){e+=this.stmts[t].nb()}if(this.stmts[t].is_value)e+="return ";e+=this.stmts[t].nb();return e};b.prototype=new h;b.prototype.is_compound_stmt=true;b.prototype.toBlock=function(){i(this.pctx);a(this,this.pctx);return l(this.pctx)};w.prototype=new h;w.prototype.is_value=true;w.prototype.nblock_val=function(){return this.exp.nb()+";"};w.prototype.v=function(e){return this.exp.v(e)};x.prototype=new h;x.prototype.is_var_decl=true;x.prototype.collect_var_decls=function(e){try{this.d[0].collect_var_decls(e)}catch(t){throw new Error("Invalid syntax in variable declaration")}};x.prototype.nblock_val=function(){return this.d[0].name+"="+this.d[1].nb()+";"};x.prototype.val=function(){if(this.is_dest){return(new U(this.d[0],"=",this.d[1],this.pctx)).val()}else return"__oni_rt.Sc("+this.line+",function(_oniX){return "+this.d[0].name+"=_oniX;},"+this.d[1].v()+")"};T.prototype=new h;T.prototype.nblock_val=function(){var e="if("+this.t.nb()+"){"+this.c.nb()+"}";if(this.a)e+="else{"+this.a.nb()+"}";return e};T.prototype.val=function(){var e;var t=this.c.v();if(this.t.is_nblock){e="__oni_rt.Nb(function(){if("+this.t.nb()+")return __oni_rt.ex("+t+",this);";if(this.a)e+="else return __oni_rt.ex("+this.a.v()+",this);";return e+"},"+this.line+")"}else{e="__oni_rt.If("+this.t.v()+","+t;if(this.a)e+=","+this.a.v();return e+")"}};N.prototype=new h;N.prototype.nblock_val=function(){var e="try{"+this.block.nb()+"}";if(this.crf[0]){if(this.crf[0][2])throw new Error("catchall statement not allowed in __js block");e+="catch("+this.crf[0][0]+"){"+this.crf[0][1].nb()+"}"}if(this.crf[1])throw new Error("retract statement not allowed in __js block");if(this.crf[2])e+="finally{"+this.crf[2].nb()+"}";return e};N.prototype.val=function(){var e=this.block.v();var t="__oni_rt.Try("+(this.crf[0]&&this.crf[0][2]?1:0);t+=","+e;if(this.crf[0]){var n=this.crf[0][1].v();t+=",function(__oni_env,"+this.crf[0][0]+"){";if(n.length)t+="return __oni_rt.ex("+n+",__oni_env)";t+="}"}else t+=",0";if(this.crf[2]){var r=this.crf[2].v();t+=","+r}else t+=",0";if(this.crf[1]){var i=this.crf[1].v();t+=","+i}return t+")"};var C=new h;C.is_nblock=true;C.nblock_val=function(){return";"};C.v=function(){return"0"};k.prototype=new h;k.prototype.nblock_val=function(){return"throw "+this.exp.nb()+";"};k.prototype.val=function(){return"__oni_rt.Sc("+this.line+",__oni_rt.Throw,"+this.exp.v()+","+this.line+","+this.file+")"};L.prototype=new h;L.prototype.val=function(){var e=this.exp?","+this.exp.v():"";return"__oni_rt.Sc("+this.line+",__oni_rt.BlReturn"+e+")"};A.prototype=new h;A.prototype.nblock_val=function(){var e;if(this.js_ctx){e="return";if(this.exp)e+=" "+this.exp.nb();e+=";"}else{e="return __oni_rt.Return(";if(this.exp)e+=this.exp.nb();e+=");"}return e};A.prototype.val=function(){var e=this.exp?","+this.exp.v():"";return"__oni_rt.Sc("+this.line+",__oni_rt.Return"+e+")"};O.prototype=new h;O.prototype.val=function(){return"__oni_rt.Collapse("+this.line+")"};M.prototype=new h;M.prototype.nblock_val=function(){var e;if(this.js_ctx){e=this.f=="b"?"break":"continue";if(this.lbl)e+=" "+this.lbl;e+=";"}else{e="return __oni_rt."+(this.f=="b"?"Break":"Cont")+"(";if(this.lbl)e+="'"+this.lbl+"'";e+=");"}return e};_.prototype=new h;_.prototype.nblock_val=function(){if(this.js_ctx)throw new Error("Blocklamdas cannot contain 'break' statements in __js{...} contexts");var e="return __oni_rt.BlBreak(this";if(this.lbl)e+=",'"+this.lbl+"'";e+=");";return e};P.prototype=new h;P.prototype.nblock_val=function(){if(this.init_state==2){return"do{"+this.body.nb()+"}while("+this.test_exp.nb()+");"}else if(this.test_exp&&this.inc_exp){return"for(;"+this.test_exp.nb()+";"+this.inc_exp.nb()+"){"+this.body.nb()+"}"}else if(this.test_exp){return"while("+this.test_exp.nb()+"){"+this.body.nb()+"}"}else throw new Error("Can't encode this loop as __js yet")};P.prototype.val=function(){var e=this.test_exp?this.test_exp.v():"1";var t=this.body.v(true);return"__oni_rt.Loop("+this.init_state+","+e+","+(this.inc_exp?this.inc_exp.v():"0")+","+t+")"};B.prototype=new h;B.prototype.nblock_val=function(){return"for("+this.lhs.nb()+" in "+this.obj.nb()+"){"+this.body.nb()+"}"};B.prototype.val=function(){var e="__oni_rt.ForIn("+this.obj.v();e+=",function(__oni_env, _oniY) { return __oni_rt.ex(__oni_rt.Seq("+0+",";e+=(new U(this.lhs,"=",new K("_oniY",this.pctx),this.pctx)).v();if(this.body)e+=","+this.body.v();return e+"), __oni_env)})"};j.prototype=new h;j.prototype.nblock_val=function(){return"with("+this.exp.nb()+")"+this.body.nb()};j.prototype.val=function(){var e="__oni_rt.Sc("+this.line+",__oni_rt.With,"+this.exp.v()+",function(__oni_env,__oni_z){with(__oni_z) return __oni_rt.ex("+this.body.v()+",__oni_env)})";return e};F.prototype=new h;F.prototype.is_nblock=true;F.prototype.v=function(){return this.value};F.prototype.nblock_val=function(){return this.value};F.prototype.destruct=function(){if(this.value!="")throw new Error("invalid pattern");return""};F.prototype.collect_var_decls=function(){};I.prototype=new h;I.prototype.is_value=true;I.prototype.collect_pars=function(e){if(this.id!=",")throw new Error("invalid parameter list syntax");e.push(this.left);if(this.right.collect_pars)this.right.collect_pars(e);else e.push(this.right)};I.prototype.nblock_val=function(){return this.left.nb()+" "+this.id+" "+this.right.nb()};I.prototype.val=function(){if(this.is_nblock){return c(this.nb(),true,this.line)}else if(this.id=="||"){return"__oni_rt.Seq("+2+","+this.left.v()+","+this.right.v()+")"}else if(this.id=="&&"){return"__oni_rt.Seq("+4+","+this.left.v()+","+this.right.v()+")"}else return"__oni_rt.Sc("+this.line+",__oni_rt.infix['"+this.id+"'],"+this.left.v()+","+this.right.v()+")"};q.prototype=new h;q.prototype.is_value=true;q.prototype.nblock_val=function(){for(var e=0,t=this.parts.length;e<t;++e){var n=this.parts[e];if(Array.isArray(n)){this.parts[e]="("+n[0].nb()+")"}else{this.parts[e]='"'+n+'"'}}return"("+this.parts.join("+")+")"};q.prototype.val=function(){if(this.is_nblock)return c(this.nb(),true,this.line);for(var e=0,t=this.parts.length;e<t;++e){var n=this.parts[e];if(Array.isArray(n)){this.parts[e]=n[0].v()}else{this.parts[e]='"'+n+'"'}}return"__oni_rt.Sc("+this.line+",__oni_rt.join_str,"+this.parts.join(",")+")"};R.prototype=new h;R.prototype.is_value=true;R.prototype.val=function(){var e="__oni_rt.Sc("+this.line+",__oni_rt.Quasi";for(var t=0;t<this.parts.length;++t){if(t%2)e+=","+this.parts[t].v();else e+=',"'+this.parts[t].replace(/\"/g,'\\"')+'"'}return e+")"};U.prototype=new h;U.prototype.is_value=true;U.prototype.nblock_val=function(){var e=this.right.nb();if(this.left.name==="__oni_altns")e="Object.create("+e+")";return this.left.nb()+this.id+e};U.prototype.val=function(){var e;if(this.is_nblock){e=c(this.nb(),true,this.line)}else if(this.is_dest){e="__oni_rt.Sc("+this.line+",function(_oniX";try{var t=[],n=this.left.destruct("_oniX",t);for(var r=1;r<=t.length;++r)e+=",_oniX"+r;e+="){"+n+"return _oniX;},"+this.right.v();for(var r=0;r<t.length;++r)e+=","+t[r];e+=")"}catch(i){throw{mes:"Invalid left side in destructuring assignment ",line:this.line}}}else if(!this.left.is_ref||this.left.is_nblock){var s="_oniX";if(this.left.name==="__oni_altns")s="Object.create("+s+")";e="__oni_rt.Sc("+this.line+",function(_oniX){return "+this.left.nb()+this.id+s+";},"+this.right.v()+")"}else{e="__oni_rt.Sc("+this.line+",function(l, r){return l[0][l[1]]"+this.id+"r;},"+this.left.ref()+","+this.right.v()+")"}return e};z.prototype=new h;z.prototype.is_value=true;z.prototype.nblock_val=function(){return this.id+" "+this.right.nb()};z.prototype.val=function(){var e;if(this.id=="spawn")e="__oni_rt.Spawn("+this.line+","+this.right.v()+")";else if(this.right.is_nblock){e=c(this.nb(),true,this.line)}else if(this.right.is_ref){e="__oni_rt.Sc("+this.line+",function(r){return "+this.id+" r[0][r[1]]},"+this.right.ref()+")"}else{e="__oni_rt.Sc("+this.line+",function(r){return "+this.id+" r},"+this.right.v()+")"}return e};W.prototype=new h;W.prototype.is_value=true;W.prototype.nblock_val=function(){return this.left.nb()+this.id+" "};W.prototype.val=function(){var e;if(this.left.is_nblock){e=c(this.nb(),true,this.line)}else if(this.left.is_ref){e="__oni_rt.Sc("+this.line+",function(l){return l[0][l[1]]"+this.id+"},"+this.left.ref()+")"}return e};V.prototype=new h;V.prototype.v=function(){if(this.bound)return c(this.nb(),true,this.line);else return this.code};V.prototype.nb=function(){if(this.bound)return"("+this.code+").bind("+(this.js_ctx?"this":"this.tobj")+")";else return this.code};K.prototype=new h;K.prototype.is_nblock=true;K.prototype.is_id=true;K.prototype.is_value=true;K.prototype.nblock_val=function(){return this.name};K.prototype.destruct=function(e){if(this.name==="__oni_altns")e="Object.create("+e+")";return this.name+"="+e+";"};K.prototype.collect_var_decls=function(e){e.push(this.name)};Q.prototype=new h;Q.prototype.is_nblock=true;Q.prototype.is_id=true;Q.prototype.is_value=true;Q.prototype.nblock_val=function(){if(this.js_ctx)return this.name;else return"this."+this.ename};Q.prototype.destruct=Q.prototype.collect_var_decls=function(){throw new Error("'"+this.name+"' not allowed in destructuring pattern")};Y.prototype=new h;Y.prototype.is_value=true;Y.prototype.is_fun_call=true;Y.prototype.nblock_val=function(){var e=this.l.nb()+"(";for(var t=0;t<this.args.length;++t){if(t)e+=",";e+=this.args[t].nb()}return e+")"};Y.prototype.val=function(){var e;if(this.nblock_form){e=this.l.nb()+"(";for(var t=0;t<this.args.length;++t){if(t)e+=",";e+=this.args[t].nb()}return"__oni_rt.C(function(){return "+e+")},"+this.line+")"}else if(this.l.is_ref){e="__oni_rt.Fcall(1,"+this.line+","+this.l.ref()}else{e="__oni_rt.Fcall(0,"+this.line+","+this.l.v()}for(var t=0;t<this.args.length;++t){e+=","+this.args[t].v()}e+=")";return e};Z.prototype=new h;Z.prototype.is_ref=true;Z.prototype.is_value=true;Z.prototype.nblock_val=function(){return this.l.nb()+"."+this.name};Z.prototype.val=function(){return"__oni_rt.Sc("+this.line+",function(l){return l."+this.name+";},"+this.l.v()+")"};Z.prototype.ref=function(){return"__oni_rt.Sc("+this.line+",function(l){return [l,'"+this.name+"'];},"+this.l.v()+")"};Z.prototype.destruct=function(e,t){t.push(this.ref());var n="_oniX"+t.length;return n+"[0]["+n+"[1]]="+e+";"};Z.prototype.collect_var_decls=function(e){if(this.l instanceof K&&this.l.name==="__oni_altns")return;throw new Error("var declaration must not contain property accessor as lvalue")};et.prototype=new h;et.prototype.is_ref=true;et.prototype.is_value=true;et.prototype.nblock_val=function(){return this.l.nb()+"["+this.idxexp.nb()+"]"};et.prototype.val=function(){return"__oni_rt.Sc("+this.line+",function(l, idx){return l[idx];},"+this.l.v()+","+this.idxexp.v()+")"};et.prototype.ref=function(){if(this.is_nblock)return"__oni_rt.Nb(function(){return ["+this.l.nb()+","+this.idxexp.nb()+"]},"+this.line+")";else return"__oni_rt.Sc("+this.line+",function(l, idx){return [l, idx];},"+this.l.v()+","+this.idxexp.v()+")"};tt.prototype=new h;tt.prototype.is_value=true;tt.prototype.nblock_val=function(){return"("+this.e.nb()+")"};tt.prototype.v=function(e){return this.e.v(e)};tt.prototype.destruct=function(e,t){return this.e.destruct(e,t)};tt.prototype.collect_var_decls=function(e){return this.e.collect_var_decls(e)};tt.prototype.collect_pars=function(e){if(this.e.collect_pars)this.e.collect_pars(e);else e.push(this.e)};nt.prototype=new h;nt.prototype.is_value=true;nt.prototype.nblock_val=function(){var e="[";for(var t=0;t<this.elements.length;++t){if(t)e+=",";e+=this.elements[t].nb()}return e+"]"};nt.prototype.val=function(){var e="__oni_rt.Sc("+this.line+",__oni_rt.Arr";for(var t=0;t<this.elements.length;++t){e+=","+this.elements[t].v()}return e+")"};nt.prototype.destruct=function(e,t){var n="";for(var r=0;r<this.elements.length;++r){n+=this.elements[r].destruct(e+"["+r+"]",t)}return n};nt.prototype.collect_var_decls=function(e){for(var t=0;t<this.elements.length;++t)this.elements[t].collect_var_decls(e)};rt.prototype=new h;rt.prototype.is_value=true;rt.prototype.nblock_val=function(){var e="{";for(var t=0;t<this.props.length;++t){if(t!=0)e+=",";e+=this.props[t][1]+":"+this.props[t][2].nb()}return e+"}"};rt.prototype.val=function(){var e="__oni_rt.Sc("+this.line+",__oni_rt.Obj, [";for(var t=0;t<this.props.length;++t){if(t)e+=",";if(this.props[t][0]=="pat")throw{mes:"Missing initializer for object property "+it(this.props[t][1]),line:this.props[t][2]};e+=it(this.props[t][1])}e+="]";for(var t=0;t<this.props.length;++t){e+=","+this.props[t][2].v()}return e+")"};rt.prototype.destruct=function(e,t){var n="";for(var r=0;r<this.props.length;++r){var i=this.props[r];var s=i[1];var o;if(o=i[1].charAt(0)==="@"){s=i[1].slice(1)}if(i[0]=="pat"){var u=i[1];if(o)u="__oni_altns."+s;n+=u+"="+e+"."+s+";"}else n+=i[2].destruct(e+"["+it(s)+"]",t)}return n};rt.prototype.collect_var_decls=function(e){for(var t=0;t<this.props.length;++t){var n=this.props[t];if(n[0]=="pat"){if(n[1].charAt(0)==="@")continue;e.push(n[1])}else n[2].collect_var_decls(e)}};st.prototype=new h;st.prototype.is_value=true;st.prototype.nblock_val=function(){return this.t.nb()+"?"+this.c.nb()+":"+(this.a?this.a.nb():"undefined")};st.prototype.val=function(){return"__oni_rt.If("+this.t.v()+","+this.c.v()+","+(this.a?this.a.v():"undefined")+")"};ot.prototype=new h;ot.prototype.is_value=true;ot.prototype.nblock_val=function(){var e="new "+this.exp.nb()+"(";for(var t=0;t<this.args.length;++t){if(t)e+=",";e+=this.args[t].nb()}return e+")"};ot.prototype.val=function(){var e="__oni_rt.Fcall(2,"+this.line+","+this.exp.v();for(var t=0;t<this.args.length;++t){e+=","+this.args[t].v()}e+=")";return e};at.prototype=new h;at.prototype.is_nblock=false;at.prototype.val=function(){var e="__oni_rt.";if(this.op=="and")e+="Par(";else e+="Alt(";for(var t=0;t<this.blocks.length;++t){var n=this.blocks[t].v();if(t)e+=",";e+=n}return e+")"};ct.prototype=new h;ct.prototype.val=function(){var e="__oni_rt.Suspend(function(__oni_env,";if(this.wrapped)e+="_oniX){resume=_oniX;";else e+="resume){";var t=this.block.v();if(t.length)e+="return __oni_rt.ex("+t+",__oni_env)";e+="}, function() {";for(var n=0;n<this.decls.length;++n){var r=this.decls[n][0].name;if(r=="arguments")throw new Error("Cannot use 'arguments' as variable name in waitfor()");e+=r+"=arguments["+n+"];"}e+="})";return e};ht.prototype=new h;ht.prototype.val=function(){return"__oni_rt.Nb(function(){var resume;"+"return __oni_rt.ex("+this.code+",this)},"+this.line+")"};dt.prototype=new h;dt.prototype.val=function(){var e="__oni_rt.Nb(function(){var _oniW;"+"return __oni_rt.ex(__oni_rt.Seq("+0+","+this.assign1.v()+",";if(this.assign2)e+=this.assign2.v()+",";e+="__oni_rt.Try("+0+","+this.body.v()+",0,"+"__oni_rt.Nb(function(){if(_oniW&&_oniW.__finally__)return _oniW.__finally__()},"+this.line+"),0)),this)},"+this.line+")";return e};vt.prototype=new h;vt.prototype.val=function(){return this.code};mt.prototype=new h;mt.prototype.nblock_val=function(){return this.lbl+": "+this.stmt.nb()};mt.prototype.val=function(){throw new Error("labeled statements not implemented yet")};gt.prototype={lookup:function(e){return this["$"+e]},put:function(e,t){this["$"+e]=t},del:function(e){delete this["$"+e]}};var yt=/(?:[ \f\t\v\u00A0\u2028\u2029]+|\/\/.*|#!.*)*(?:((?:(?:\r\n|\n|\r)|\/\*(?:.|\n|\r)*?\*\/)+)|((?:0[xX][\da-fA-F]+)|(?:(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][-+]?\d+)?))|(\/(?:\\.|\[(?:\\[^\r\n]|[^\n\r\]])*\]|[^\[\/\r\n])+\/[gimy]*)|(==|!=|->|=>|>>|<<|<=|>=|--|\+\+|\|\||&&|\.\.|[-*\/%+&^|]=|[;,?:|^&=<>+\-*\/%!~.\[\]{}()\"`]|[$@_\w]+)|('(?:\\[^\r\n]|[^\\\'\r\n])*')|('(?:\\(?:(?:[^\r\n]|(?:\r\n|\n|\r)))|[^\\\'])*')|(\S+))/g;var bt=/(?:[ \f\t\v\u00A0\u2028\u2029]+|\/\/.*|#!.*)*(?:((?:(?:\r\n|\n|\r)|\/\*(?:.|\n|\r)*?\*\/)+)|(>>>=|===|!==|>>>|<<=|>>=|==|!=|->|=>|>>|<<|<=|>=|--|\+\+|\|\||&&|\.\.|[-*\/%+&^|]=|[;,?:|^&=<>+\-*\/%!~.\[\]{}()\"`]|[$@_\w]+))/g;var wt=/((?:\\[^\r\n]|\#(?!\{)|[^#\\\"\r\n])+)|(\\(?:\r\n|\n|\r))|((?:\r\n|\n|\r))|(\"|\#\{)/g;var Et=/((?:\\[^\r\n]|\$(?![\{a-zA-Z_$@])|[^$\\\`\r\n])+)|(\\(?:\r\n|\n|\r))|((?:\r\n|\n|\r))|(\`|\$\{|\$(?=[a-zA-Z_$@]))/g;St.prototype={exsf:function(e){throw new Error("Unexpected '"+this+"'")},excbp:0,excf:function(e,t){throw new Error("Unexpected '"+this+"'")},stmtf:null,tokenizer:yt,toString:function(){return"'"+this.id+"'"},exs:function(e){this.exsf=e;return this},exc:function(e,t){this.excbp=e;if(t)this.excf=t;return this},stmt:function(e){this.stmtf=e;return this},ifx:function(e,t){this.excbp=e;if(t)e-=.5;this.excf=function(t,n){var r=zt(n,e);return new I(t,this.id,r,n)};return this},asg:function(e,t){this.excbp=e;if(t)e-=.5;this.excf=function(t,n){var r=zt(n,e);return new U(t,this.id,r,n)};return this},pre:function(e){return this.exs(function(t){var n=zt(t,e);return new z(this.id,n,t)})},pst:function(e){return this.exc(e,function(e,t){return new W(e,this.id,t)})}};xt.prototype=new St;xt.prototype.tokenizer=bt;xt.prototype.toString=function(){return"literal '"+this.value+"'"};xt.prototype.exsf=function(e){return new F(this.value,e,this.id)};Tt.prototype=new xt("<id>");Tt.prototype.exsf=function(e){if(this.alternate===true){if(this.value.length){return new Z(new K("__oni_altns",e),this.value,e)}else{return new K("__oni_altns",e)}}else{return J(this.value,e)}};var Nt=new gt;Ct("[").exs(function(e){var t=[];while(e.token.id!="]"){if(t.length)Xt(e,",");if(e.token.id==","){t.push(function(e){return new F("",e)}(e))}else if(e.token.id=="]")break;else t.push(zt(e,110))}Xt(e,"]");return new nt(t,e)}).exc(270,function(e,t){var n=zt(t);Xt(t,"]");return new et(e,n,t)});Ct(".").exc(270,function(e,t){if(t.token.id!="<id>")throw new Error("Expected an identifier, found '"+t.token+"' instead");var n=t.token.value;Xt(t);return new Z(e,n,t)});Ct("new").exs(function(e){var t=zt(e,260);var n=[];if(e.token.id=="("){Xt(e);while(e.token.id!=")"){if(n.length)Xt(e,",");n.push(zt(e,110))}Xt(e,")")}return new ot(t,n)});Ct("(").exs(function(e){if(e.token.id==")"){var t=Xt(e,")");if(t.id!="->"&&t.id!="=>")throw new Error("Was expecting '->' or '=>' after empty parameter list, but saw '"+e.token.id+"'");Xt(e);return t.exsf(e)}var n=zt(e);Xt(e,")");return new tt(n,e)}).exc(260,function(e,t){var n=[];while(t.token.id!=")"){if(n.length)Xt(t,",");n.push(zt(t,110))}Xt(t,")");if(t.token.id=="{"){yt.lastIndex=t.lastIndex;while(1){var r=yt.exec(t.src);if(r&&(r[4]=="|"||r[4]=="||")){n.push(Ot(Xt(t).id,t))}else if(r&&r[1]){continue}break}}return new Y(e,n,t)});Ct("..").exc(255,function(e,t){var n=zt(t,255);return $(e,n,t)});Ct("++").pre(240).pst(250).asi_restricted=true;Ct("--").pre(240).pst(250).asi_restricted=true;Ct("delete").pre(240);Ct("void").pre(240);Ct("typeof").pre(240);Ct("+").pre(240).ifx(220);Ct("-").pre(240).ifx(220);Ct("~").pre(240);Ct("!").pre(240);Ct("*").ifx(230);Ct("/").ifx(230);Ct("%").ifx(230);Ct("<<").ifx(210);Ct(">>").ifx(210);Ct(">>>").ifx(210);Ct("<").ifx(200);Ct(">").ifx(200);Ct("<=").ifx(200);Ct(">=").ifx(200);Ct("instanceof").ifx(200);Ct("in").ifx(200);Ct("==").ifx(190);Ct("!=").ifx(190);Ct("===").ifx(190);Ct("!==").ifx(190);Ct("&").ifx(180);Ct("^").ifx(170);Ct("|").ifx(160);Ct("&&").ifx(150);Ct("||").ifx(140);Ct("?").exc(130,function(e,t){var n=zt(t,110);if(t.token.id==":"){Xt(t,":");var r=zt(t,110)}return new st(e,n,r,t)});Ct("=").asg(120,true);Ct("*=").asg(120,true);Ct("/=").asg(120,true);Ct("%=").asg(120,true);Ct("+=").asg(120,true);Ct("-=").asg(120,true);Ct("<<=").asg(120,true);Ct(">>=").asg(120,true);Ct(">>>=").asg(120,true);Ct("&=").asg(120,true);Ct("^=").asg(120,true);Ct("|=").asg(120,true);Ct("->").exs(function(e){var t=zt(e,119.5);return new V(undefined,t,e)}).exc(120,function(e,t){var n=zt(t,119.5);return new V(e,n,t)});Ct("=>").exs(function(e){var t=zt(e,119.5);return new V(undefined,t,e,true)}).exc(120,function(e,t){var n=zt(t,119.5);return new V(e,n,t,true)});Ct("spawn").pre(115);Ct(",").ifx(110,true);Ct("{").exs(function(e){var t=e.token.id;if(t=="|"||t=="||"){return Ot(t,e)}else{var n=[];while(e.token.id!="}"){if(n.length)Xt(e,",");var r=e.token;if(r.id=="}")break;r=kt(r,e);Xt(e);if(e.token.id==":"){Xt(e);var i=zt(e,110);n.push(["prop",r,i])}else if(e.token.id=="}"||e.token.id==","){if(r.charAt(0)=="'"||r.charAt(0)=='"')throw new Error("Quoted identifiers not allowed in destructuring patterns ("+r+")");n.push(["pat",r,e.line])}else throw new Error("Unexpected token '"+e.token+"'")}Xt(e,"}",bt);return new rt(n,e)}}).exc(260,function(e,t){var n=t.token.id;if(n!="|"&&n!="||")throw new Error("Unexpected token '"+t.token+"' - was expecting '|' or '||'");var r=[Ot(n,t)];return new Y(e,r,t);}).stmt(Lt);Ct(";").stmt(function(e){return C});Ct(")",bt);Ct("]",bt);Ct("}");Ct(":");Ct("<eof>").exs(function(e){throw new Error("Unexpected end of input (exs)")}).stmt(function(e){throw new Error("Unexpected end of input (stmt)")});Ct("function").exs(function(e){var t="";if(e.token.id=="<id>"){t=e.token.value;Xt(e)}var n=Dt(e);var r=Mt(e);return new v(t,n,r,e,false)}).stmt(function(e){if(e.token.id!="<id>")throw new Error("Malformed function declaration");var t=e.token.value;Xt(e);var n=Dt(e);var r=Mt(e);return m(t,n,r,e)});Ct("this",bt).exs(function(e){return new Q("this","tobj",e)});Ct("true",bt).exs(function(e){return new F("true",e)});Ct("false",bt).exs(function(e){return new F("false",e)});Ct("null",bt).exs(function(e){return new F("null",e)});Ct("collapse",bt).exs(function(e){return new O(e)});Ct('"',wt).exs(function(e){var t=[],n=-1;while(e.token.id!='istr-"'){switch(e.token.id){case"<string>":if(n!=-1&&typeof t[n]=="string"){t[n]+=e.token.value}else{t.push(e.token.value);++n}break;case"istr-#{":Xt(e);t.push([zt(e)]);++n;break;case"<eof>":throw new Error("Unterminated string");break;default:throw new Error("Internal parser error: Unknown token in string ("+e.token+")")}Xt(e,undefined,wt)}Xt(e);if(n==-1){t.push("");n=0}if(n==0&&typeof t[0]=="string"){var r='"'+t[0]+'"';return new F(r,e,"<string>")}return new q(t,e)});Ct("istr-#{",yt);Ct('istr-"',bt);Ct("`",Et).exs(function(e){var t=[],n=0;while(e.token.id!="quasi-`"){switch(e.token.id){case"<string>":if(n%2)t[n-1]+=e.token.value;else{t.push(e.token.value);++n}break;case"quasi-${":Xt(e);if(n%2==0){t.push("");++n}t.push(zt(e));++n;break;case"quasi-$":if(n%2==0){t.push("");++n}t.push(Pt(e));++n;break;case"<eof>":throw new Error("Unterminated string");break;default:throw new Error("Internal parser error: Unknown token in string ("+e.token+")")}Xt(e,undefined,Et)}Xt(e);if(n==0){t.push("")}return new R(t,e);});Ct("quasi-${",yt);Ct("quasi-$",yt);Ct("quasi-`",bt);Ct("var").stmt(function(e){var t=jt(e);Bt(e);return S(t,e)});Ct("else");Ct("if").stmt(function(e){Xt(e,"(");var t=zt(e);Xt(e,")");var n=Ut(e);var r=null;if(e.token.id=="else"){Xt(e);r=Ut(e)}return new T(t,n,r,e)});Ct("while").stmt(function(e){Xt(e,"(");var t=zt(e);Xt(e,")");++r(e).break_scope;++r(e).continue_scope;var n=Ut(e);--r(e).break_scope;--r(e).continue_scope;return new P(0,t,n)});Ct("do").stmt(function(e){++r(e).break_scope;++r(e).continue_scope;var t=Ut(e);--r(e).break_scope;--r(e).continue_scope;Xt(e,"while");Xt(e,"(");var n=zt(e);Xt(e,")");Bt(e);return new P(2,n,t)});Ct("for").stmt(function(e){Xt(e,"(");var t=null;var n=null;if(e.token.id=="var"){Xt(e);n=jt(e,true)}else{if(e.token.id!=";")t=Wt(e)}if(e.token.id==";"){Xt(e);var i=null;if(e.token.id!=";")i=zt(e);Xt(e,";");var s=null;if(e.token.id!=")")s=zt(e);Xt(e,")");++r(e).break_scope;++r(e).continue_scope;var o=Ut(e);--r(e).break_scope;--r(e).continue_scope;return D(t,n,i,s,o,e)}else if(e.token.id=="in"){Xt(e);if(n&&n.length>1)throw new Error("More than one variable declaration in for-in loop");var u=zt(e);Xt(e,")");++r(e).break_scope;++r(e).continue_scope;var o=Ut(e);--r(e).break_scope;--r(e).continue_scope;var a=n?n[0]:null;return H(t,a,u,o,e)}else throw new Error("Unexpected token '"+e.token+"' in for-statement")});Ct("continue").stmt(function(e){var t=null;if(e.token.id=="<id>"&&!e.newline){t=e.token.value;Xt(e)}Bt(e);if(r(e).continue_scope)return new M("c",e,t);else if(r(e).bl)return new A(undefined,e);else throw new Error("Unexpected 'continue' statement")});Ct("break").stmt(function(e){var t=null;if(e.token.id=="<id>"&&!e.newline){t=e.token.value;Xt(e)}Bt(e);if(r(e).break_scope)return new M("b",e,t);else if(r(e).bl)return new _(e,t);else throw new Error("Unexpected 'break' statement")});Ct("return").stmt(function(e){var t=null;if(!Ht(e.token)&&!e.newline)t=zt(e);Bt(e);if(r(e).bl)return new L(t,e);else return new A(t,e)});Ct("with").stmt(function(e){Xt(e,"(");var t=zt(e);Xt(e,")");var n=Ut(e);return new j(t,n,e)});Ct("case");Ct("default");Ct("switch").stmt(function(e){Xt(e,"(");var t=zt(e);Xt(e,")");Xt(e,"{");++r(e).break_scope;var n=[];while(e.token.id!="}"){var s=null;if(e.token.id=="case"){Xt(e);s=zt(e)}else if(e.token.id=="default"){Xt(e)}else throw new Error("Invalid token '"+e.token+"' in switch statement");Xt(e,":");i(e);o(e).exp=s;while(e.token.id!="case"&&e.token.id!="default"&&e.token.id!="}"){var u=Ut(e);a(u,e)}n.push(function(e){return[o(e).exp,l(e)]}(e))}--r(e).break_scope;Xt(e,"}");return new d(t,n);t,n,e});Ct("throw").stmt(function(e){if(e.newline)throw new Error("Illegal newline after throw");var t=zt(e);Bt(e);return new k(t,e);});Ct("catch");Ct("finally");Ct("try").stmt(function(e){Xt(e,"{");var t=Lt(e);var n=e.token.value;if(n!="and"&&n!="or"){var r=Ft(e);if(!r[0]&&!r[1]&&!r[2])throw new Error("Missing 'catch', 'finally' or 'retract' after 'try'");return new N(t,r,e)}else{var i=[t];do{Xt(e);Xt(e,"{");i.push(Lt(e))}while(e.token.value==n);var r=Ft(e);return ut(n,i,r,e)}});Ct("waitfor").stmt(function(e){if(e.token.id=="{"){Xt(e,"{");var t=[Lt(e)];var n=e.token.value;if(n!="and"&&n!="or")throw new Error("Missing 'and' or 'or' after 'waitfor' block");do{Xt(e);Xt(e,"{");t.push(Lt(e))}while(e.token.value==n);var i=Ft(e);return ut(n,t,i,e)}else{Xt(e,"(");var s=e.token.id=="var";if(s)Xt(e);var o=[];if(e.token.id==")"){if(s)throw new Error("Missing variables in waitfor(var)")}else o=jt(e);Xt(e,")");Xt(e,"{");++r(e).fscoped_ctx;var u=Lt(e);var i=Ft(e);--r(e).fscoped_ctx;return ft(s,o,u,i,e)}});Ct("using").stmt(function(e){var t;Xt(e,"(");if(t=e.token.id=="var")Xt(e);var n,r;var i=zt(e,120);if(e.token.id=="="){n=i;Xt(e);r=zt(e)}else{if(t)throw new Error("Syntax error in 'using' expression");r=i}Xt(e,")");var s=Ut(e);return pt(t,n,r,s,e)});Ct("__js").stmt(function(e){if(e.allow_nblock)++e.js_ctx;var t=Ut(e);if(e.allow_nblock)--e.js_ctx;t.is_nblock=e.allow_nblock;return t});Ct("abstract");Ct("boolean");Ct("byte");Ct("char");Ct("class");Ct("const");Ct("debugger");Ct("double");Ct("enum");Ct("export");Ct("extends");Ct("final");Ct("float");Ct("goto");Ct("implements");Ct("import");Ct("int");Ct("interface");Ct("long");Ct("native");Ct("package");Ct("private");Ct("protected");Ct("public");Ct("short");Ct("static");Ct("super");Ct("synchronized");Ct("throws");Ct("transient");Ct("volatile");e.compile=qt})(__oni_rt.c1={});__oni_rt.modsrc["builtin:apollo-sys-common.sjs"]='__oni_rt.sys=exports;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar UNDEF;\n\n\n\n\n\nif(!(__oni_rt.G.__oni_rt_bundle)){\n__oni_rt.G.__oni_rt_bundle={};\n}\n\n\n\n\n\n\n\n\n\nexports.hostenv=__oni_rt.hostenv;\n\n\n\n\n\n__js exports.getGlobal=function(){return __oni_rt.G};\n\n\n\n\n\n\n\n\n\n__js exports.isArrayLike=function(obj){return Array.isArray(obj)||!!(obj&&Object.prototype.hasOwnProperty.call(obj,\'callee\'))||!!(__oni_rt.G.NodeList&&obj instanceof NodeList)||!!(__oni_rt.G.FileList&&obj instanceof FileList)||!!(__oni_rt.G.StaticNodeList&&obj instanceof StaticNodeList);\n\n\n\n\n\n};\n\n\n\n\n\n\n\n\n\n\n\n__js {\nvar _flatten=function(arr,rv){var l=arr.length;\n\nfor(var i=0;i<l;++i){\nvar elem=arr[i];\nif(exports.isArrayLike(elem))_flatten(elem,rv);else rv.push(elem);\n\n\n\n}\n};\n\nexports.flatten=function(arr){var rv=[];\n\nif(arr.length===UNDEF)throw new Error("flatten() called on non-array");\n_flatten(arr,rv);\nreturn rv;\n};\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n__js exports.expandSingleArgument=function(args){if(args.length==1&&exports.isArrayLike(args[0]))args=args[0];\n\n\nreturn args;\n};\n\n\n\n\n\n\n\n\n\n__js exports.isQuasi=function(obj){return (obj instanceof __oni_rt.QuasiProto);\n\n};\n\n\n\n\n\n\n__js exports.Quasi=function(arr){return __oni_rt.Quasi.apply(__oni_rt,arr)};\n\n\n\n\n\n\n__js exports.mergeObjects=function(){var rv={};\n\nvar sources=exports.expandSingleArgument(arguments);\nfor(var i=0;i<sources.length;i++ ){\nexports.extendObject(rv,sources[i]);\n}\nreturn rv;\n};\n\n\n\n\n\n__js exports.extendObject=function(dest,source){for(var o in source){\n\nif(Object.prototype.hasOwnProperty.call(source,o))dest[o]=source[o];\n}\nreturn dest;\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n__js {\nfunction URI(){}\nURI.prototype={toString:function(){\nreturn "#{this.protocol}://#{this.authority}#{this.relative}";\n\n}};\n\nURI.prototype.params=function(){if(!this._params){\n\nvar rv={};\nthis.query.replace(parseURLOptions.qsParser,function(_,k,v){if(k)rv[decodeURIComponent(k)]=decodeURIComponent(v);\n\n});\nthis._params=rv;\n}\nreturn this._params;\n};\n\nvar parseURLOptions={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],qsParser:/(?:^|&)([^&=]*)=?([^&]*)/g,parser:/^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/};\n\n\n\n\n\n\nexports.parseURL=function(str){var o=parseURLOptions,m=o.parser.exec(str),uri=new URI(),i=14;\n\n\n\n\nwhile(i-- )uri[o.key[i]]=m[i]||"";\nreturn uri;\n};\n}\n\n\n\n\n\n\n\n\n\n__js exports.constructQueryString=function(){var hashes=exports.flatten(arguments);\n\nvar hl=hashes.length;\nvar parts=[];\nfor(var h=0;h<hl;++h){\nvar hash=hashes[h];\nfor(var q in hash){\nvar l=encodeURIComponent(q)+"=";\nvar val=hash[q];\nif(!exports.isArrayLike(val))parts.push(l+encodeURIComponent(val));else{\n\n\nfor(var i=0;i<val.length;++i)parts.push(l+encodeURIComponent(val[i]));\n\n}\n}\n}\nreturn parts.join("&");\n};\n\n\n\n\n\n\n\n\n__js exports.constructURL=function(){var url_spec=exports.flatten(arguments);\n\nvar l=url_spec.length;\nvar rv=url_spec[0];\n\n\nfor(var i=1;i<l;++i){\nvar comp=url_spec[i];\nif(typeof comp!="string")break;\nif(rv.charAt(rv.length-1)!="/")rv+="/";\nrv+=comp.charAt(0)=="/"?comp.substr(1):comp;\n}\n\n\nvar qparts=[];\nfor(;i<l;++i){\nvar part=exports.constructQueryString(url_spec[i]);\nif(part.length)qparts.push(part);\n\n}\nvar query=qparts.join("&");\nif(query.length){\nif(rv.indexOf("?")!=-1)rv+="&";else rv+="?";\n\n\n\nrv+=query;\n}\nreturn rv;\n};\n\n\n\n\n\n\n\n__js exports.isSameOrigin=function(url1,url2){var a1=exports.parseURL(url1).authority;\n\nif(!a1)return true;\nvar a2=exports.parseURL(url2).authority;\nreturn !a2||(a1==a2);\n};\n\n\n\n\n\n\n\n\n\n\n__js exports.canonicalizeURL=function(url,base){if(__oni_rt.hostenv=="nodejs"&&__oni_rt.G.process.platform==\'win32\'){\n\n\n\nurl=url.replace(/\\\\/g,"/");\nbase=base.replace(/\\\\/g,"/");\n}\n\nvar a=exports.parseURL(url);\n\n\nif(base&&(base=exports.parseURL(base))&&(!a.protocol||a.protocol==base.protocol)){\n\nif(!a.directory&&!a.protocol){\na.directory=base.directory;\nif(!a.path&&(a.query||a.anchor))a.file=base.file;\n\n}else if(a.directory&&a.directory.charAt(0)!=\'/\'){\n\n\na.directory=(base.directory||"/")+a.directory;\n}\nif(!a.protocol){\na.protocol=base.protocol;\nif(!a.authority)a.authority=base.authority;\n\n}\n}\n\n\nvar pin=a.directory.split("/");\nvar l=pin.length;\nvar pout=[];\nfor(var i=0;i<l;++i){\nvar c=pin[i];\nif(c==".")continue;\nif(c==".."&&pout.length>1)pout.pop();else pout.push(c);\n\n\n\n}\na.directory=pout.join("/");\n\n\nvar rv="";\nif(a.protocol)rv+=a.protocol+":";\nif(a.authority)rv+="//"+a.authority;else if(a.protocol=="file")rv+="//";\n\n\n\nrv+=a.directory+a.file;\nif(a.query)rv+="?"+a.query;\nif(a.anchor)rv+="#"+a.anchor;\nreturn rv;\n};\n\n\n\n\n\n\n\n\n\n\n\nexports.jsonp=jsonp_hostenv;\n\n\n\n\n\n\n\nexports.getXDomainCaps=getXDomainCaps_hostenv;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nexports.request=request_hostenv;\n\n\n\n\n\n\nexports.makeMemoizedFunction=function(f,keyfn){var lookups_in_progress={};\n\n\nvar memoizer=function(){var key=keyfn?keyfn.apply(this,arguments):arguments[0];\n\nvar rv=memoizer.db[key];\nif(typeof rv!==\'undefined\')return rv;\nif(!lookups_in_progress[key])lookups_in_progress[key]=spawn (function(self,args){\nreturn memoizer.db[key]=f.apply(self,args);\n\n})(this,arguments);\ntry{\nreturn lookups_in_progress[key].waitforValue();\n}finally{\n\nif(lookups_in_progress[key].waiting()==0){\nlookups_in_progress[key].abort();\ndelete lookups_in_progress[key];\n}\n}\n};\n\nmemoizer.db={};\nreturn memoizer;\n};\n\n\n\n\n\n\n\nexports.eval=eval_hostenv;\n\n\n\n\nvar pendingLoads={};\n\n\n\n\nfunction makeRequire(parent){var rf=function(module,settings){\n\n__js var opts=exports.extendObject({},settings);\n\nif(opts.callback){\ntry{\nvar rv=exports.isArrayLike(module)?requireInnerMultiple(module,rf,parent,opts):requireInner(module,rf,parent,opts);\n}catch(e){\nopts.callback(e);return;\n}\nopts.callback(UNDEF,rv);\nreturn;\n}else return exports.isArrayLike(module)?requireInnerMultiple(module,rf,parent,opts):requireInner(module,rf,parent,opts);\n\n\n};\n\n__js {\n\nrf.resolve=function(module,settings){var opts=exports.extendObject({},settings);\n\nreturn resolve(module,rf,parent,opts);\n};\n\nrf.url=function(relative){return resolve(relative,rf,parent,{loader:\'dummy\'}).path;\n\n\n};\n\nrf.path="";\nrf.alias={};\n\n\nif(exports.require){\nrf.hubs=exports.require.hubs;\nrf.modules=exports.require.modules;\nrf.extensions=exports.require.extensions;\n}else{\n\n\nrf.hubs=augmentHubs(getHubs_hostenv());\nrf.modules={};\n\nrf.extensions=getExtensions_hostenv();\n}\n\n}\n\nreturn rf;\n}\nexports._makeRequire=makeRequire;\n\n__js function augmentHubs(hubs){hubs.addDefault=function(hub){\n\nif(!this.defined(hub[0])){\n\nthis.push(hub);\nreturn true;\n}\nreturn false;\n};\nhubs.defined=function(prefix){for(var i=0;i<this.length;i++ ){\n\nvar h=this[i][0];\nvar l=Math.min(h.length,prefix.length);\nif(h.substr(0,l)==prefix.substr(0,l))return true;\n}\nreturn false;\n};\nreturn hubs;\n}\n\nfunction html_sjs_extractor(html,descriptor){var re=/<script (?:[^>]+ )?(?:type=[\'"]text\\/sjs[\'"]|main=[\'"]([^\'"]+)[\'"])[^>]*>((.|[\\r\\n])*?)<\\/script>/mg;\n\nvar match;\nvar src=\'\';\nwhile(match=re.exec(html)){\nif(match[1])src+=\'require("\'+match[1]+\'")\';else src+=match[2];\n\nsrc+=\';\';\n}\nif(!src)throw new Error("No sjs found in HTML file");\nreturn default_compiler(src,descriptor);\n}\n\n\n__js function resolveAliases(module,aliases){var ALIAS_REST=/^([^:]+):(.*)$/;\n\nvar alias_rest,alias;\nvar rv=module;\nvar level=10;\nwhile((alias_rest=ALIAS_REST.exec(rv))&&(alias=aliases[alias_rest[1]])){\n\nif(--level==0)throw new Error("Too much aliasing in modulename \'"+module+"\'");\n\nrv=alias+alias_rest[2];\n}\nreturn rv;\n}\n\n\n__js function resolveHubs(module,hubs,require_obj,parent,opts){var path=module;\n\nvar loader=opts.loader||default_loader;\nvar src=opts.src||default_src_loader;\nvar resolve=default_resolver;\n\n\nif(path.indexOf(":")==-1)path=resolveSchemelessURL_hostenv(path,require_obj,parent);\n\n\nvar level=10;\nfor(var i=0,hub;hub=hubs[i++ ];){\nif(path.indexOf(hub[0])==0){\n\nif(typeof hub[1]=="string"){\npath=hub[1]+path.substring(hub[0].length);\ni=0;\n\nif(path.indexOf(":")==-1)path=resolveSchemelessURL_hostenv(path,require_obj,parent);\n\nif(--level==0)throw new Error("Too much indirection in hub resolution for module \'"+module+"\'");\n\n}else if(typeof hub[1]=="object"){\n\nif(hub[1].src)src=hub[1].src;\nif(hub[1].loader)loader=hub[1].loader;\nresolve=hub[1].resolve||loader.resolve||resolve;\n\nbreak;\n}else throw new Error("Unexpected value for require.hubs element \'"+hub[0]+"\'");\n\n\n}\n}\n\nreturn {path:path,loader:loader,src:src,resolve:resolve};\n}\n\n\n__js function default_src_loader(path){throw new Error("Don\'t know how to load module at "+path);\n\n}\n\n\nvar compiled_src_tag=/^\\/\\*\\__oni_compiled_sjs_1\\*\\//;\nfunction default_compiler(src,descriptor){var f;\n\n\nif(typeof (src)===\'function\'){\nf=src;\n}else if(compiled_src_tag.exec(src)){\n\n\n\n\n\n\nf=new Function("module","exports","require","__onimodulename","__oni_altns",src);\n}else{\n\nf=exports.eval("(function(module,exports,require, __onimodulename, __oni_altns){"+src+"\\n})",{filename:"module #{descriptor.id}"});\n\n}\nf(descriptor,descriptor.exports,descriptor.require,"module #{descriptor.id}",{});\n\n}\n\ndefault_compiler.module_args=[\'module\',\'exports\',\'require\',\'__onimodulename\',\'__oni_altns\'];\n\nfunction default_loader(path,parent,src_loader,opts,spec){var compile=exports.require.extensions[spec.type];\n\nif(!compile)throw new Error("Unknown type \'"+spec.type+"\'");\n\n\nvar descriptor=exports.require.modules[path];\nvar pendingHook=pendingLoads[path];\n\nif(!descriptor&&!pendingHook){\n\npendingHook=pendingLoads[path]=spawn (function(){waitfor{\n\nvar src,loaded_from;\nif(typeof src_loader==="string"){\nsrc=src_loader;\nloaded_from="[src string]";\n}else if(path in __oni_rt.modsrc){\n\n\nloaded_from="[builtin]";\nsrc=__oni_rt.modsrc[path];\ndelete __oni_rt.modsrc[path];\n\n}else{\n\n({src,loaded_from})=src_loader(path);\n}\nvar descriptor={id:path,exports:{},loaded_from:loaded_from,loaded_by:parent,required_by:{}};\n\n\n\n\n\n\ndescriptor.require=makeRequire(descriptor);\n\nif(opts.main)descriptor.require.main=descriptor;\nexports.require.modules[path]=descriptor;\ntry{\ncompile(src,descriptor);\nreturn descriptor;\n}catch(e){\ndelete exports.require.modules[path];\nthrow e;\n}retract{\ndelete exports.require.modules[path];\n}\n}or{\nwaitfor(){\nhold(0);\npendingHook.resume=resume;\n}\n}\n})();\n}\n\nif(pendingHook){\n\n\n\nvar p=parent;\n\n\n\n\n\nwhile(p.loaded_by){\nif(path===p.id)return descriptor.exports;\n\np=p.loaded_by;\n}\n\n\ntry{\ndescriptor=pendingHook.waitforValue();\n}retract{\n\nif(pendingHook.waiting()==0&&pendingHook.resume){\npendingHook.resume();\npendingHook.value();\n}\n}finally{\n\n\nif(pendingHook.waiting()==0)delete pendingLoads[path];\n\n}\n}\n\nif(!descriptor.required_by[parent.id])descriptor.required_by[parent.id]=1;else ++descriptor.required_by[parent.id];\n\n\n\n\nreturn descriptor.exports;\n}\n\n__js function default_resolver(spec){if(!spec.ext)spec.path+="."+spec.type;\n\n\n};\n\n\nfunction http_src_loader(path){return {src:request_hostenv([path,{format:\'compiled\'}],{mime:\'text/plain\'}),loaded_from:path};\n\n\n\n\n}\n\n\n\n\n\n\nvar github_api="https://api.github.com/";\nvar github_opts={cbfield:"callback"};\nfunction github_src_loader(path){var user,repo,tag;\n\ntry{\n[ ,user,repo,tag,path]=/github:\\/([^\\/]+)\\/([^\\/]+)\\/([^\\/]+)\\/(.+)/.exec(path);\n}catch(e){throw new Error("Malformed module id \'"+path+"\'")}\n\nvar url=exports.constructURL(github_api,\'repos\',user,repo,"contents",path,{ref:tag});\n\nwaitfor{\nvar data=jsonp_hostenv(url,github_opts).data;\n}or{\n\nhold(10000);\nthrow new Error("Github timeout");\n}\nif(data.message&&!data.content)throw new Error(data.message);\n\n\n\nvar str=exports.require(\'sjs:string\');\n\nreturn {src:str.utf8ToUtf16(str.base64ToOctets(data.content)),loaded_from:url};\n\n\n\n}\n\n\nfunction resolve(module,require_obj,parent,opts){var path=resolveAliases(module,require_obj.alias);\n\n\n\nvar hubs=exports.require.hubs;\n\nvar resolveSpec=resolveHubs(path,hubs,require_obj,parent,opts);\n\n\nresolveSpec.path=exports.canonicalizeURL(resolveSpec.path,parent.id);\n\n\n\nvar ext,extMatch=/.+\\.([^\\.\\/]+)$/.exec(resolveSpec.path);\nif(extMatch){\next=extMatch[1].toLowerCase();\nresolveSpec.ext=ext;\nif(!exports.require.extensions[ext])ext=null;\n}\nresolveSpec.type=ext||\'sjs\';\n\nresolveSpec.resolve(resolveSpec,parent);\n\n__js {\n\nvar preload=__oni_rt.G.__oni_rt_bundle;\nvar pendingHubs=false;\nif(preload.h){\n\nvar deleteHubs=[];\nfor(var k in preload.h){\nif(!Object.prototype.hasOwnProperty.call(preload.h,k))continue;\nvar entries=preload.h[k];\nvar parent=getTopReqParent_hostenv();\nvar resolved=resolveHubs(k,hubs,exports.require,parent,{});\nif(resolved.path===k){\n\npendingHubs=true;\ncontinue;\n}\n\nfor(var i=0;i<entries.length;i++ ){\nvar ent=entries[i];\npreload.m[resolved.path+ent[0]]=ent[1];\n}\ndeleteHubs.push(k);\n}\n\nif(!pendingHubs)delete preload.h;else{\n\n\nfor(var i=0;i<deleteHubs.length;i++ )delete preload.h[deleteHubs[i]];\n\n}\n}\n\nif(module in __oni_rt.modsrc){\n\n\nif(!preload.m)preload.m={};\npreload.m[resolveSpec.path]=__oni_rt.modsrc[module];\ndelete __oni_rt.modsrc[module];\n}\n\nif(preload.m){\nvar path=resolveSpec.path;\n\nif(path.indexOf(\'!sjs\',path.length-4)!==-1)path=path.slice(0,-4);\n\nvar contents=preload.m[path];\nif(contents!==undefined){\nresolveSpec.src=function(){delete preload.m[path];\n\n\nreturn {src:contents,loaded_from:path+"#bundle"};\n};\n}\n}\n\n}\nreturn resolveSpec;\n}\n\n\n\n\n\n__js exports.resolve=function(url,require_obj,parent,opts){require_obj=require_obj||exports.require;\n\nparent=parent||getTopReqParent_hostenv();\nopts=opts||{};\nreturn resolve(url,require_obj,parent,opts);\n};\n\n\nfunction requireInner(module,require_obj,parent,opts){var resolveSpec=resolve(module,require_obj,parent,opts);\n\n\n\n\nmodule=resolveSpec.loader(resolveSpec.path,parent,resolveSpec.src,opts,resolveSpec);\nif(opts.copyTo){\nexports.extendObject(opts.copyTo,module);\n}\n\nreturn module;\n}\n\n\nfunction requireInnerMultiple(modules,require_obj,parent,opts){var rv={};\n\n\n\n\nfunction inner(i,l){if(l===1){\n\nvar descriptor=modules[i];\nvar id,exclude,include,name;\n__js if(typeof descriptor===\'string\'){\nid=descriptor;\nexclude=[];\ninclude=null;\nname=null;\n}else{\n\nid=descriptor.id;\nexclude=descriptor.exclude||[];\ninclude=descriptor.include||null;\nname=descriptor.name||null;\n}\n\nvar module=requireInner(id,require_obj,parent,opts);\n\n\n__js {\nvar addSym=function(k,v){if(rv[k]!==undefined){\n\nif(rv[k]===v)return;\nthrow new Error("require([.]) name clash while merging module \'#{id}\': Symbol \'#{k}\' defined in multiple modules");\n}\nrv[k]=v;\n};\n\nif(name){\naddSym(name,module);\n}else if(include){\nfor(var i=0;i<include.length;i++ ){\nvar o=include[i];\nif(!(o in module))throw new Error("require([.]) module #{id} has no symbol #{o}");\naddSym(o,module[o]);\n}\n}else{\nfor(var o in module){\n\n\n\nif(exclude.indexOf(o)!==-1)continue;\naddSym(o,module[o]);\n}\n}\n}\n}else{\n\nvar split=Math.floor(l/2);\nwaitfor{\ninner(i,split);\n}and{\n\ninner(i+split,l-split);\n}\n}\n}\n\n\ninner(0,modules.length);\n\nreturn rv;\n}\n\n\n__js exports.require=makeRequire(getTopReqParent_hostenv());\n\n__js exports.require.modules[\'builtin:apollo-sys.sjs\']={id:\'builtin:apollo-sys.sjs\',exports:exports,loaded_from:"[builtin]",required_by:{"[system]":1}};\n\n\n\n\n\n\nexports.init=function(cb){init_hostenv();\n\ncb();\n};\n\n';__oni_rt.modsrc["builtin:apollo-sys-xbrowser.sjs"]='var location;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n__js function determineLocation(){if(!location){\n\nlocation={};\nvar scripts=document.getElementsByTagName("script"),matches;\nfor(var i=0;i<scripts.length;++i){\nif((matches=/^(.*\\/)(?:[^\\/]*)stratified(?:[^\\/]*)\\.js(?:\\?.*)?$/.exec(scripts[i].src))){\nlocation.location=exports.canonicalizeURL(matches[1]+"modules/",document.location.href);\nlocation.requirePrefix=scripts[i].getAttribute("require-prefix");\nlocation.req_base=scripts[i].getAttribute("req-base")||document.location.href;\nlocation.main=scripts[i].getAttribute("main");\nbreak;\n}\n}\n}\nreturn location;\n}\n\n\n\n\nif(determineLocation().requirePrefix){\n__oni_rt.G[determineLocation().requirePrefix]={require:__oni_rt.sys.require};\n}else __oni_rt.G.require=__oni_rt.sys.require;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction jsonp_hostenv(url,settings){var opts=exports.mergeObjects({iframe:false,cbfield:"callback"},settings);\n\n\n\n\n\n\n\n\n\n\nurl=exports.constructURL(url,opts.query);\nif(opts.iframe||opts.forcecb)return jsonp_iframe(url,opts);else return jsonp_indoc(url,opts);\n\n\n\n};\n\nvar jsonp_req_count=0;\nvar jsonp_cb_obj="_oni_jsonpcb";\nfunction jsonp_indoc(url,opts){if(!window[jsonp_cb_obj])window[jsonp_cb_obj]={};\n\n\nvar cb="cb"+(jsonp_req_count++ );\nvar cb_query={};\ncb_query[opts.cbfield]=jsonp_cb_obj+"."+cb;\nurl=exports.constructURL(url,cb_query);\nvar elem=document.createElement("script");\nelem.setAttribute("src",url);\nelem.setAttribute("async","async");\nelem.setAttribute("type","text/javascript");\nvar complete=false;\nwaitfor(var rv){\nwindow[jsonp_cb_obj][cb]=resume;\ndocument.getElementsByTagName("head")[0].appendChild(elem);\n\nwaitfor(){\nif(elem.addEventListener)elem.addEventListener("error",resume,false);else{\n\n\nvar readystatechange=function(){if(elem.readyState==\'loaded\'&&!complete)resume();\n\n};\nelem.attachEvent("onreadystatechange",readystatechange);\n}\n}finally{\n\nif(elem.removeEventListener)elem.removeEventListener("error",resume,false);else elem.detachEvent("onreadystatechange",readystatechange);\n\n\n\n}\n\nthrow new Error("Could not complete JSONP request to \'"+url+"\'");\n}finally{\n\nelem.parentNode.removeChild(elem);\ndelete window[jsonp_cb_obj][cb];\n}\ncomplete=true;\nreturn rv;\n}\n\nfunction jsonp_iframe(url,opts){var cb=opts.forcecb||"R";\n\nvar cb_query={};\nif(opts.cbfield)cb_query[opts.cbfield]=cb;\n\nurl=exports.constructURL(url,cb_query);\nvar iframe=document.createElement("iframe");\ndocument.getElementsByTagName("head")[0].appendChild(iframe);\nvar doc=iframe.contentWindow.document;\nwaitfor(var rv){\ndoc.open();\niframe.contentWindow[cb]=resume;\n\n\nhold(0);\ndoc.write("\\x3Cscript type=\'text/javascript\' src=\\""+url+"\\">\\x3C/script>");\ndoc.close();\n}finally{\n\niframe.parentNode.removeChild(iframe);\n}\n\n\nhold(0);\nreturn rv;\n};\n\n\nvar XHR_caps;\nvar activex_xhr_ver;\n\nfunction getXHRCaps(){if(!XHR_caps){\n\nXHR_caps={};\n\nif(__oni_rt.G.XMLHttpRequest)XHR_caps.XHR_ctor=function(){\nreturn new XMLHttpRequest()};else XHR_caps.XHR_ctor=function(){\n\nif(typeof activex_xhr_ver!==\'undefined\')return new ActiveXObject(activex_xhr_ver);\n\n\nfor(var v in {"MSXML2.XMLHTTP.6.0":1,"MSXML2.XMLHTTP.3.0":1,"MSXML2.XMLHTTP":1}){\n\n\n\n\ntry{\nvar req=new ActiveXObject(v);\nactivex_xhr_ver=v;\nreturn req;\n}catch(e){\n}\n}\nthrow new Error("Browser does not support XMLHttpRequest");\n};\n\n\nXHR_caps.XHR_CORS=("withCredentials" in XHR_caps.XHR_ctor());\nif(!XHR_caps.XHR_CORS)XHR_caps.XDR=(typeof __oni_rt.G.XDomainRequest!==\'undefined\');\n\nXHR_caps.CORS=(XHR_caps.XHR_CORS||XHR_caps.XDR)?"CORS":"none";\n}\nreturn XHR_caps;\n}\n\n\n\n\n\n\nfunction getXDomainCaps_hostenv(){return getXHRCaps().CORS;\n\n}\n\n\n\n\n\n__js function getTopReqParent_hostenv(){var base=determineLocation().req_base;\n\nreturn {id:base,loaded_from:base,required_by:{"[system]":1}};\n\n\n\n}\n\n\n\n\n\n\n\n\n\n__js function resolveSchemelessURL_hostenv(url_string,req_obj,parent){if(req_obj.path&&req_obj.path.length)url_string=exports.constructURL(req_obj.path,url_string);\n\n\nreturn exports.canonicalizeURL(url_string,parent.id);\n}\n\n\n\n\n\n\nfunction request_hostenv(url,settings){var opts=exports.mergeObjects({method:"GET",body:null,response:\'string\',throwing:true},settings);\n\n\n\n\n\n\n\n\n\n\n\nurl=exports.constructURL(url,opts.query);\n\nvar caps=getXHRCaps();\nif(!caps.XDR||exports.isSameOrigin(url,document.location)){\nvar req=caps.XHR_ctor();\nreq.open(opts.method,url,true,opts.username||"",opts.password||"");\n}else{\n\n\nreq=new XDomainRequest();\nreq.open(opts.method,url);\n}\n\nwaitfor(var error){\nif(typeof req.onerror!==\'undefined\'){\nreq.onload=function(){resume()};\nreq.onerror=function(){resume(true)};\nreq.onabort=function(){resume(true)};\n}else{\n\nreq.onreadystatechange=function(evt){if(req.readyState!=4)return;else resume();\n\n\n\n\n};\n}\n\nif(opts.headers&&req.setRequestHeader)for(var h in opts.headers)req.setRequestHeader(h,opts.headers[h]);\n\n\n\n\n\nif(opts.mime&&req.overrideMimeType)req.overrideMimeType(opts.mime);\n\nif(opts.response===\'arraybuffer\')req.responseType=\'arraybuffer\';\n\n\nreq.send(opts.body);\n}retract{\n\nreq.abort();\n}\n\n\nif(error||(typeof req.status!==\'undefined\'&&!(req.status.toString().charAt(0) in {\'0\':1,\'2\':1}))){\n\n\nif(opts.throwing){\nvar txt="Failed "+opts.method+" request to \'"+url+"\'";\nif(req.statusText)txt+=": "+req.statusText;\nif(req.status)txt+=" ("+req.status+")";\nvar err=new Error(txt);\nerr.status=req.status;\nerr.data=req.response;\nthrow err;\n}else if(opts.response===\'string\'){\n\nreturn "";\n}\n\n}\nif(opts.response===\'string\')return req.responseText;else if(opts.response===\'arraybuffer\'){\n\n\nreturn {status:req.status,content:req.response,getHeader:name->req.getResponseHeader(name)};\n\n\n\n\n}else{\n\n\nreturn {status:req.status,content:req.responseText,getHeader:name->req.getResponseHeader(name)};\n\n\n\n\n}\n}\n\n\n\n\n__js function getHubs_hostenv(){return [["sjs:",determineLocation().location||{src:function(path){\n\n\nthrow new Error("Can\'t load module \'"+path+"\': The location of the StratifiedJS standard module lib is unknown - it can only be inferred automatically if you load stratified.js in the normal way through a <script> element.");\n\n}}],["github:",{src:github_src_loader}],["http:",{src:http_src_loader}],["https:",{src:http_src_loader}],["file:",{src:http_src_loader}],["x-wmapp1:",{src:http_src_loader}],["local:",{src:http_src_loader}]];\n\n\n\n\n\n\n\n\n\n\n\n\n}\n\nfunction getExtensions_hostenv(){return {\'sjs\':default_compiler,\'js\':function(src,descriptor){\n\n\n\n\n\nvar f=new Function("module","exports",src);\n\nf.apply(descriptor.exports,[descriptor,descriptor.exports]);\n},\'html\':html_sjs_extractor};\n\n\n\n}\n\n\n\n\nfunction eval_hostenv(code,settings){if(__oni_rt.UA=="msie"&&__oni_rt.G.execScript)return eval_msie(code,settings);\n\n\n\nvar filename=(settings&&settings.filename)||"sjs_eval_code";\nfilename="\'#{filename.replace(/\\\'/g,\'\\\\\\\'\')}\'";\nvar mode=(settings&&settings.mode)||"normal";\nvar js=__oni_rt.c1.compile(code,{filename:filename,mode:mode});\nreturn __oni_rt.G.eval(js);\n}\n\n\n\n\n\n\n\nvar IE_resume_counter=0;\n__oni_rt.IE_resume={};\nfunction eval_msie(code,settings){var filename=(settings&&settings.filename)||"sjs_eval_code";\n\nfilename="\'#{filename.replace(/\\\'/g,\'\\\\\\\'\')}\'";\nvar mode=(settings&&settings.mode)||"normal";\ntry{\nwaitfor(var rv,isexception){\nvar rc=++IE_resume_counter;\n__oni_rt.IE_resume[rc]=resume;\nvar js=__oni_rt.c1.compile("try{"+code+"\\n}catchall(rv) { spawn(hold(0),__oni_rt.IE_resume["+rc+"](rv[0],rv[1])) }",{filename:filename,mode:mode});\n\n\n__oni_rt.G.execScript(js);\n}\nif(isexception)throw rv;\n}finally{\n\ndelete __oni_rt.IE_resume[rc];\n}\nreturn rv;\n}\n\n\n\n\nfunction init_hostenv(){}\n\n\n\n\nif(!__oni_rt.G.__oni_rt_no_script_load){\nfunction runScripts(){var scripts=document.getElementsByTagName("script");\n\n\n\n\n\n\n\n\n\nvar ss=[];\nfor(var i=0;i<scripts.length;++i){\nvar s=scripts[i];\nif(s.getAttribute("type")=="text/sjs"){\nss.push(s);\n}\n}\n\nfor(var i=0;i<ss.length;++i){\nvar s=ss[i];\nvar m=s.getAttribute("module");\n\nvar content=s.textContent||s.innerHTML;\nif(__oni_rt.UA=="msie"){\n\ncontent=content.replace(/\\r\\n/,"");\n}\nif(m)__oni_rt.modsrc[m]=content;else{\n\n\nvar descriptor={id:document.location.href+"_inline_sjs_"+(i+1)};\n\n\n__oni_rt.sys.require.main=descriptor;\nvar f=exports.eval("(function(module, __onimodulename){"+content+"\\n})",{filename:"module #{descriptor.id}"});\n\nf(descriptor);\n}\n}\n\nvar mainModule=determineLocation().main;\nif(mainModule){\n__oni_rt.sys.require(mainModule,{main:true});\n}\n};\n\nif(document.readyState==="complete"){\nrunScripts();\n}else{\n\n\nif(__oni_rt.G.addEventListener)__oni_rt.G.addEventListener("load",runScripts,true);else __oni_rt.G.attachEvent("onload",runScripts);\n\n\n\n}\n}\n\n\n';if(!Array.isArray){Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){var t=this.length>>>0;var n=Math.floor(arguments[1]||0);if(n<0)n=Math.max(t-Math.abs(n),0);for(;n<t;++n){if(n in this&&this[n]===e)return n}return-1}}if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(e){var t=this.length>>>0;var n=arguments[1]===undefined?t:Math.floor(arguments[1]);if(n>=0)n=Math.min(n,t-1);else n+=t;for(;n>=0;--n){if(n in this&&this[n]===e)return n}return-1}}if(!Object.create){Object.create=function(t){function n(){}n.prototype=t;return new n}}if(!Object.keys){Object.keys=function(e){var t=[],n;for(n in e)if(Object.prototype.hasOwnProperty.call(e,n))t.push(n);return t}}if(!Object.getPrototypeOf){Object.getPrototypeOf="".__proto__===String.prototype?function(e){return e.__proto__}:function(e){return e.constructor.prototype}}if(!Function.prototype.bind){Function.prototype.bind=function(e){var t=[].slice,n=t.call(arguments,1),r=this,i=function(){},s=function(){var s=e||{};try{if(this instanceof i)s=this}catch(o){}return r.apply(s,n.concat(t.call(arguments)))};i.prototype=r.prototype;s.prototype=new i;return s}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!__oni_rt.sys){__oni_rt.G.eval("(function(exports) {"+__oni_rt.c1.compile(__oni_rt.modsrc["builtin:apollo-sys-common.sjs"],{filename:"'apollo-sys-common.sjs'"})+"\n"+__oni_rt.c1.compile(__oni_rt.modsrc["builtin:apollo-sys-"+__oni_rt.hostenv+".sjs"],{filename:"'apollo-sys-"+__oni_rt.hostenv+".sjs'"})+"})({})");delete __oni_rt.modsrc["builtin:apollo-sys-common.sjs"];delete __oni_rt.modsrc["builtin:apollo-sys-"+__oni_rt.hostenv+".sjs"]};
