<?php if($odbcdsn==""){$odbcdsn="ojored";};if($odbcuid==""){$odbcuid="sa";};if($odbcpwd==""){$odbcpwd="grouse";};function odbcInsert($tablename,$fieldnames,$fieldvalues){global $odbcdsn;global $odbcuid;global $odbcpwd;global $lcd;$odbccon=odbc_connect($odbcdsn,$odbcuid,$odbcpwd);if(count($fieldnames)!=count($fieldvalues)){return("Error: Values and fields do not match");}else{$cmdtext="INSERT INTO ".$tablename." (";for($i=0;$i<count($fieldvalues);$i++){$cmdtext.=$fieldname[$i].",";}$cmdtext=trim($cmtext,",");$cmdtext.=") ";for($i=0;$i<count($fieldvalues);$i++){$cmdtext.="'".$fieldvalues[$i]."',";}$cmdtext=trim($cmtext,",");$result=odbc_exec($odbccon,$cmdtext);if(!$result){$errormsg="Error: SQL statement failed with error: \n";$errormsg.=odbc_error($odbccon).": ".odbc_errormsg($odbccon)."\n";return($errormsg);}else{return("One data row inserted.\n");}}odbc_close($odbccon);}function odbcUpdate($tablename,$fieldnames,$fieldvalues,$rowkey,$rowid){global $odbcdsn;global $odbcuid;global $odbcpwd;global $lcd;$odbccon=odbc_connect($odbcdsn,$odbcuid,$odbcpwd);if(count($fieldnames)!=count($fieldvalues)){return("Error: Values and fields do not match");}else{$cmdtext="UPDATE ".$tablename." SET (";for($i=0;$i<count($fieldvalues);$i++){$cmdtext.=$fieldname[$i]." = '".$fieldvalues[$i]."',";;}$cmdtext=trim($cmtext,",");$cmdtext.=") WHERE ".$rowkey." = '".$rowid."'";$result=odbc_exec($odbccon,$cmdtext);if(!$result){$errormsg="Error: SQL statement failed with error: \n";$errormsg.=odbc_error($odbccon).": ".odbc_errormsg($odbccon)."\n";return($errormsg);}else{return("One data row updated.\n");}}odbc_close($odbccon);}function odbcDelete($tablename,$rowkey,$rowid){global $odbcdsn;global $odbcuid;global $odbcpwd;global $lcd;$odbccon=odbc_connect($odbcdsn,$odbcuid,$odbcpwd);$cmdtext="DELETE FROM ".$tablename." WHERE ".$rowkey." = '".$rowid."'";$result=odbc_exec($odbccon,$cmdtext);if(!$result){$errormsg="Error: SQL statement failed with error: \n";$errormsg.=odbc_error($odbccon).": ".odbc_errormsg($odbccon)."\n";return($errormsg);}else{return("Row(s) deleted.\n");}odbc_close($odbccon);}function odbcSelect($tablename,$wherestr,$sidx,$sord,$start,$limit){global $odbcdsn;global $odbcuid;global $odbcpwd;global $lcd;global $total_pages;global $page;$odbccon=odbc_connect($odbcdsn,$odbcuid,$odbcpwd);$s="";$s="{";$s.="totalpages:".$total_pages.", \n\f";$s.="currpage:".$page.", \n\f";$s.="totalrecords:".$count.", \n\f";$s.=$tablename.":[ \n\f";$selectstr="SELECT * FROM ".$tablename." ".$wherestr." ORDER BY $sidx $sord LIMIT $start , $limit";$rowset=odbc_exec($odbccon,$selectstr);$i=0;$fCount=odbc_num_fields($rowset);while(odbc_fetch_row($rowset)){$s.="{";while($i<$fCount){$i++;$fName=odbc_field_name($rowset,$i);$job[$fName]=htmlentities(odbc_result($rowset,$i));$s.=$fName.": ".$job[$fName].",";}$s=trim($s,",");$s.="},";$i=0;}$s=trim($s,",");$s.="]";$s.="}";return($s);odbc_free_result($rowset);odbc_close($odbccon);}function odbcTestFld($tablename,$fieldnames,$params){global $odbcdsn;global $odbcuid;global $odbcpwd;global $lcd;$odbccon=odbc_connect($odbcdsn,$odbcuid,$odbcpwd);$selectstr="SELECT * FROM ".$tablename." ".$params;$rowset=odbc_exec($odbccon,$selectstr);while($row=odbc_fetch_array($rowset)){for($i=0;$i<count($fieldnames);$i++){$s.=$fieldnames[$i].": ".htmlentities($row[$fieldnames[$i]])."<br />";}}return($s);odbc_free_result($rowset);odbc_close($odbccon);}function odbcTest($tablename,$params){global $odbcdsn;global $odbcuid;global $odbcpwd;global $lcd;$odbccon=odbc_connect($odbcdsn,$odbcuid,$odbcpwd);$selectstr="SELECT * FROM ".$tablename." ".$params;$rowset=odbc_exec($odbccon,$selectstr);$s="";$i=0;$fCount=odbc_num_fields($rowset);while(odbc_fetch_row($rowset)){while($i<$fCount){$i++;$fName=odbc_field_name($rowset,$i);$job[$fName]=odbc_result($rowset,$i);$s.=$fName.": ".$job[$fName]."<br />";}$i=0;$s.="<br />";}return($s);odbc_free_result($rowset);odbc_close($odbccon);}function odbcGet($tablename,$fieldname,$selectfield,$fieldval){global $odbcdsn;global $odbcuid;global $odbcpwd;global $lcd;$odbccon=odbc_connect($odbcdsn,$odbcuid,$odbcpwd);$selectstr="SELECT ".$fieldname." FROM ".$tablename." WHERE ".$selectfield." = '".$fieldval."'";$rowset=odbc_exec($odbccon,$selectstr);while(odbc_fetch_row($rowset)){$s=odbc_result($rowset,$fieldname);};return(htmlentities($s));odbc_free_result($rowset);odbc_close($odbccon);}?>